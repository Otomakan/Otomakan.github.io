!function(t){function e(s){if(i[s])return i[s].exports;var r=i[s]={exports:{},id:s,loaded:!1};return t[s].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}({0:function(t,e,i){(function(t){"use strict";function e(t){return t&&t.__esModule?t:{"default":t}}var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},r=i(568),n=e(r);t.Giphy=t.Giphy||{},t.Giphy.renderCreationTools=function(t){new n["default"](s({},t))}}).call(e,function(){return this}())},339:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var r=i(340);e.override=s(r);var n=i(343);e.deprecate=s(n),e.deprecated=s(n);var o=i(344);e.suppressWarnings=s(o);var a=i(345);e.memoize=s(a);var l=i(346);e.autobind=s(l);var h=i(347);e.readonly=s(h);var u=i(348);e.enumerable=s(u);var p=i(349);e.nonenumerable=s(p);var d=i(350);e.nonconfigurable=s(d);var c=i(351);e.debounce=s(c);var f=i(352);e.throttle=s(f);var v=i(353);e.decorate=s(v);var g=i(354);e.mixin=s(g),e.mixins=s(g);var m=i(342);e.lazyInitialize=s(m);var y=i(355);e.time=s(y);var _=i(356);e.extendDescriptor=s(_);var w=i(357);e.applyDecorators=s(w)},340:function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return t.hasOwnProperty("value")?"data":t.hasOwnProperty("get")||t.hasOwnProperty("set")?"accessor":"data"}function n(t,e,i){i.assert(t.length===e.length)}function o(t,e,i){var s=typeof t.value,r=typeof e.value;if("undefined"===s&&"undefined"===r&&i.error("descriptor values are both undefined. (class properties are are not currently supported)'"),s!==r){var o="function"===r&&void 0===s;(o||void 0!==s)&&i.error('value types do not match. {parent} is "'+s+'", {child} is "'+r+'"')}switch(r){case"function":n(t.value,e.value,i);break;default:i.error('Unexpected error. Please file a bug with: {parent} is "'+s+'", {child} is "'+r+'"')}}function a(t,e,i){var s="function"==typeof t.get,r="function"==typeof e.get,o="function"==typeof t.set,a="function"==typeof e.set;(s||r)&&(!s&&o&&i.error("{parent} is setter but {child} is getter"),!r&&a&&i.error("{parent} is getter but {child} is setter"),n(t.get,e.get,i)),(o||a)&&(!o&&s&&i.error("{parent} is getter but {child} is setter"),!a&&r&&i.error("{parent} is setter but {child} is getter"),n(t.set,e.set,i))}function l(t,e,i){var s=r(t),n=r(e);switch(s!==n&&i.error('descriptor types do not match. {parent} is "'+s+'", {child} is "'+n+'"'),n){case"data":o(t,e,i);break;case"accessor":a(t,e,i)}}function h(t,e){var i=!0,s=!1,r=void 0;try{for(var n,o=m[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var a=n.value,l=a(e);if(l in t)return l}}catch(h){s=!0,r=h}finally{try{!i&&o["return"]&&o["return"]()}finally{if(s)throw r}}return null}function u(t,e,i){i.key=e;var s=Object.getPrototypeOf(t),r=Object.getOwnPropertyDescriptor(s,e),n=new g(s,t,r,i);if(void 0===r){var o=h(s,e),a=o?'\n\n  Did you mean "'+o+'"?':"";n.error("No descriptor matching {child} was found on the prototype chain."+a)}return l(r,i,n),i}function p(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,c.decorate)(u,e)}Object.defineProperty(e,"__esModule",{value:!0});var d=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();e["default"]=p;var c=i(341),f="{child} does not properly override {parent}",v=/^function ([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?(\([^\)]*\))[\s\S]+$/,g=function(){function t(e,i,r,n){s(this,t),this.parentKlass=e,this.childKlass=i,this.parentDescriptor=r,this.childDescriptor=n}return d(t,[{key:"_getTopic",value:function(t){return void 0===t?null:"value"in t?t.value:"get"in t?t.get:"set"in t?t.set:void 0}},{key:"_extractTopicSignature",value:function(t){switch(typeof t){case"function":return this._extractFunctionSignature(t);default:return this.key}}},{key:"_extractFunctionSignature",value:function(t){var e=this;return t.toString().replace(v,function(t,i,s){return void 0===i&&(i=e.key),i+s})}},{key:"key",get:function(){return this.childDescriptor.key}},{key:"parentNotation",get:function(){return this.parentKlass.constructor.name+"#"+this.parentPropertySignature}},{key:"childNotation",get:function(){return this.childKlass.constructor.name+"#"+this.childPropertySignature}},{key:"parentTopic",get:function(){return this._getTopic(this.parentDescriptor)}},{key:"childTopic",get:function(){return this._getTopic(this.childDescriptor)}},{key:"parentPropertySignature",get:function(){return this._extractTopicSignature(this.parentTopic)}},{key:"childPropertySignature",get:function(){return this._extractTopicSignature(this.childTopic)}}]),d(t,[{key:"assert",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1];t!==!0&&this.error(f+e)}},{key:"error",value:function(t){var e=this;throw t=t.replace("{parent}",function(t){return e.parentNotation}).replace("{child}",function(t){return e.childNotation}),new SyntaxError(t)}}]),t}(),m=[function(t){return t.toLowerCase()},function(t){return t.toUpperCase()},function(t){return t+"s"},function(t){return t.slice(0,-1)},function(t){return t.slice(1,t.length)}];t.exports=e["default"]},341:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,i){var s=i[e];if(s){var r={};for(var n in s)r[n]=s[n];r.value=r.initializer?r.initializer.call(t):void 0,Object.defineProperty(t,e,r)}}function a(t){if(!t||!t.hasOwnProperty)return!1;for(var e=["value","initializer","get","set"],i=0,s=e.length;i<s;i++)if(t.hasOwnProperty(e[i]))return!0;return!1}function l(t,e){return a(e[e.length-1])?t.apply(void 0,r(e).concat([[]])):function(){return t.apply(void 0,d.call(arguments).concat([e]))}}function h(t){return t.hasOwnProperty(b)===!1&&g(t,b,{value:new w}),t[b]}function u(t){var e={};return $(t).forEach(function(i){return e[i]=m(t,i)}),e}function p(t){return function(e){return Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e}),e}}Object.defineProperty(e,"__esModule",{value:!0});var d=Array.prototype.slice,c=function(){function t(t,e,i){for(var s=0;s<e.length;s++){var r=e[s],n=r.decorators,o=r.key;if(delete r.key,delete r.decorators,r.enumerable=r.enumerable||!1,r.configurable=!0,("value"in r||r.initializer)&&(r.writable=!0),n){for(var a=0;a<n.length;a++){var l=n[a];if("function"!=typeof l)throw new TypeError("The decorator for method "+r.key+" is of the invalid type "+typeof l);r=l(t,o,r)||r}if(void 0!==r.initializer){i[o]=r;continue}}Object.defineProperty(t,o,r)}}return function(e,i,s,r,n){return i&&t(e.prototype,i,r),s&&t(e,s,n),e}}();e.isDescriptor=a,e.decorate=l,e.metaFor=h,e.getOwnPropertyDescriptors=u,e.createDefaultSetter=p;var f=i(342),v=s(f),g=Object.defineProperty,m=Object.getOwnPropertyDescriptor,y=Object.getOwnPropertyNames,_=Object.getOwnPropertySymbols,w=function(){function t(){n(this,t),o(this,"debounceTimeoutIds",e),o(this,"throttleTimeoutIds",e),o(this,"throttlePreviousTimestamps",e)}var e={};return c(t,[{key:"debounceTimeoutIds",decorators:[v["default"]],initializer:function(){return{}},enumerable:!0},{key:"throttleTimeoutIds",decorators:[v["default"]],initializer:function(){return{}},enumerable:!0},{key:"throttlePreviousTimestamps",decorators:[v["default"]],initializer:function(){return{}},enumerable:!0}],null,e),t}(),b="function"==typeof Symbol?Symbol("__core_decorators__"):"__core_decorators__",$=_?function(t){return y(t).concat(_(t))}:y;e.getOwnKeys=$},342:function(t,e,i){"use strict";function s(t,e,i){var s=i.configurable,r=i.enumerable,o=i.initializer,a=i.value;return{configurable:s,enumerable:r,get:function(){if(this!==t){var i=o?o.call(this):a;return Object.defineProperty(this,e,{configurable:s,enumerable:r,writable:!0,value:i}),i}},set:(0,n.createDefaultSetter)(e)}}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,n.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var n=i(341);t.exports=e["default"]},343:function(t,e,i){"use strict";function s(t,e,i,s){var r=n(s,2),a=r[0],h=void 0===a?l:a,u=r[1],p=void 0===u?{}:u;if("function"!=typeof i.value)throw new SyntaxError("Only functions can be marked as deprecated");var d=t.constructor.name+"#"+e;return p.url&&(h+="\n\n    See "+p.url+" for more details.\n\n"),o({},i,{value:function(){return console.warn("DEPRECATION "+d+": "+h),i.value.apply(this,arguments)}})}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,a.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var i=[],s=!0,r=!1,n=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){r=!0,n=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(r)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=r;var a=i(341),l="This function will be removed in future versions.";t.exports=e["default"]},344:function(t,e,i){"use strict";function s(){}function r(t,e,i){var r=console.warn;console.warn=s;var n=e.apply(t,i);return console.warn=r,n}function n(t,e,i){return a({},i,{value:function(){return r(this,i.value,arguments)}})}function o(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,l.decorate)(n,e)}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=o;var l=i(341);t.exports=e["default"]},345:function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){return e===Object(e)?e:t[e]||(t[e]={})}function n(t,e,i,s,r){var n=e.apply(t,i);return s[r]=n,n}function o(t){var e=void 0,i=void 0;return t.value?(e=t.value,i="value"):t.get?(e=t.get,i="get"):t.set&&(e=t.set,i="set"),{fn:e,wrapKey:i}}function a(t,e,i){console.warn("DEPRECATION: @memoize is deprecated and will be removed shortly. Use @decorate with lodash's memoize helper.\n\n  https://github.com/jayphelps/core-decorators.js#decorate");var a=o(i),l=a.fn,u=a.wrapKey,p=new WeakMap,d=Object.create(null),c=Object.create(null),f=0;return h({},i,s({},u,function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var s="0",o=0,a=e.length;o<a;o++){var h=e[o],u=r(c,h),v=p.get(u);void 0===v&&(v=++f,p.set(u,v)),s+=v}return d[s]||n(this,l,arguments,d,s)}))}function l(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,u.decorate)(a,e)}Object.defineProperty(e,"__esModule",{value:!0});var h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=l;var u=i(341);t.exports=e["default"]},346:function(t,e,i){"use strict";function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}}function n(t,e){if("undefined"==typeof WeakMap)throw new Error("Using @autobind on "+e.name+"() requires WeakMap support due to its use of super."+e.name+"()\n      See https://github.com/jayphelps/core-decorators.js/issues/20");d||(d=new WeakMap),d.has(t)===!1&&d.set(t,new WeakMap);var i=d.get(t);return i.has(e)===!1&&i.set(e,r(e,t)),i.get(e)}function o(t){var e=(0,u.getOwnPropertyDescriptors)(t.prototype),i=!0,s=!1,r=void 0;try{for(var n,o=(0,u.getOwnKeys)(e)[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var l=n.value,h=e[l];"function"==typeof h.value&&"constructor"!==l&&p(t.prototype,l,a(t.prototype,l,h))}}catch(d){s=!0,r=d}finally{try{!i&&o["return"]&&o["return"]()}finally{if(s)throw r}}}function a(t,e,i){var s=i.value,o=i.configurable,a=i.enumerable;if("function"!=typeof s)throw new SyntaxError("@autobind can only be used on functions, not: "+s);var l=t.constructor;return{configurable:o,enumerable:a,get:function(){if(this===t)return s;if(this.constructor!==l&&Object.getPrototypeOf(this).constructor===l)return s;if(this.constructor!==l&&e in this.constructor.prototype)return n(this,s);var i=r(s,this);return p(this,e,{configurable:!0,writable:!0,enumerable:!1,value:i}),i},set:(0,u.createDefaultSetter)(e)}}function l(t){return 1===t.length?o.apply(void 0,s(t)):a.apply(void 0,s(t))}function h(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return 0===e.length?function(){return l(arguments)}:l(e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=h;var u=i(341),p=Object.defineProperty,d=void 0;t.exports=e["default"]},347:function(t,e,i){"use strict";function s(t,e,i){return i.writable=!1,i}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,n.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var n=i(341);t.exports=e["default"]},348:function(t,e,i){"use strict";function s(t,e,i){return i.enumerable=!0,i}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,n.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var n=i(341);t.exports=e["default"]},349:function(t,e,i){"use strict";function s(t,e,i){return i.enumerable=!1,i}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,n.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var n=i(341);t.exports=e["default"]},350:function(t,e,i){"use strict";function s(t,e,i){return i.configurable=!1,i}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,n.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var n=i(341);t.exports=e["default"]},351:function(t,e,i){"use strict";function s(t,e,i,s){var r=n(s,2),h=r[0],u=void 0===h?l:h,p=r[1],d=void 0!==p&&p,c=i.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be debounced");return o({},i,{value:function(){var t=this,i=(0,a.metaFor)(this),s=i.debounceTimeoutIds,r=s[e],n=d&&!r,o=arguments;clearTimeout(r),s[e]=setTimeout(function(){delete s[e],d||c.apply(t,o)},u),n&&c.apply(this,o)}})}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,a.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var i=[],s=!0,r=!1,n=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){r=!0,n=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(r)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=r;var a=i(341),l=300;t.exports=e["default"]},352:function(t,e,i){"use strict";function s(t,e,i,s){var r=n(s,2),h=r[0],u=void 0===h?l:h,p=r[1],d=void 0===p?{}:p,c=i.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be throttled");return d.leading!==!1&&(d.leading=!0),d.trailing!==!1&&(d.trailing=!0),o({},i,{value:function(){var t=this,i=(0,a.metaFor)(this),s=i.throttleTimeoutIds,r=i.throttlePreviousTimestamps,n=s[e],o=r[e]||0,l=Date.now(),h=arguments;o||d.leading!==!1||(o=l);var p=u-(l-o);p<=0?(clearTimeout(n),delete s[e],r[e]=l,c.apply(this,h)):n||d.trailing===!1||(s[e]=setTimeout(function(){r[e]=d.leading===!1?0:Date.now(),delete s[e],c.apply(t,h)},p))}})}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,a.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var i=[],s=!0,r=!1,n=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){r=!0,n=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(r)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=r;var a=i(341),l=300;t.exports=e["default"]},353:function(t,e,i){"use strict";function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t){return Array.isArray(t)?t:Array.from(t)}function n(t,e,i,n){var o=r(n),l=o[0],h=o.slice(1),u=i.configurable,p=i.enumerable,d=i.writable,c=i.get,f=i.set,v=i.value,g=!!c;return{configurable:u,enumerable:p,get:function(){var t=g?c.call(this):v,i=l.call.apply(l,[this,t].concat(s(h)));if(g)return i;var r={configurable:u,enumerable:p};return r.value=i,r.writable=d,Object.defineProperty(this,e,r),i},set:g?f:(0,a.createDefaultSetter)()}}function o(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,a.decorate)(n,e)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var a=i(341);t.exports=e["default"]},354:function(t,e,i){"use strict";function s(t){return"[object Symbol]"===Object.prototype.toString.call(t)&&"object"==typeof t}function r(t,e){if(s(t)){do{if(e===Object.prototype)return"undefined"!=typeof e[t];if(e.hasOwnProperty(t))return!0}while(e=h(e));return!1}return t in e}function n(t,e){if(!e.length)throw new SyntaxError("@mixin() class "+t.name+" requires at least one mixin as an argument");for(var i=0,s=e.length;i<s;i++){var n=(0,a.getOwnPropertyDescriptors)(e[i]),o=!0,h=!1,u=void 0;try{for(var p,d=(0,a.getOwnKeys)(n)[Symbol.iterator]();!(o=(p=d.next()).done);o=!0){var c=p.value;r(c,t.prototype)||l(t.prototype,c,n[c])}}catch(f){h=!0,u=f}finally{try{!o&&d["return"]&&d["return"]()}finally{if(h)throw u}}}}function o(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return"function"==typeof e[0]?n(e[0],[]):function(t){return n(t,e)}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var a=i(341),l=Object.defineProperty,h=Object.getPrototypeOf;t.exports=e["default"]},355:function(t,e,i){"use strict";function s(t,e,i,s){var r=n(s,2),a=r[0],l=void 0===a?null:a,p=r[1],d=void 0===p?h:p,c=i.value;if(null===l&&(l=t.constructor.name+"."+e),"function"!=typeof c)throw new SyntaxError("@time can only be used on functions, not: "+c);return o({},i,{value:function(){var t=l+"-"+u;u++,d.time(t);try{return c.apply(this,arguments)}finally{d.timeEnd(t)}}})}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,a.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var i=[],s=!0,r=!1,n=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){r=!0,n=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(r)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=r;var a=i(341),l={},h={time:console.time?console.time.bind(console):function(t){l[t]=new Date},timeEnd:console.timeEnd?console.timeEnd.bind(console):function(t){var e=new Date,i=e-l[t];delete l[t],console.log(t+": "+i+"ms")}};e.defaultConsole=h;var u=0},356:function(t,e,i){"use strict";function s(t,e,i){var s=Object.getPrototypeOf(t),r=Object.getOwnPropertyDescriptor(s,e);return n({},r,{value:i.value,initializer:i.initializer,get:i.get||r.get,set:i.set||r.set})}function r(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,o.decorate)(s,e)}Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e["default"]=r;var o=i(341);t.exports=e["default"]},357:function(t,e){"use strict";function i(t,e){var i=t.prototype;for(var n in e)for(var o=e[n],a=0,l=o.length;a<l;a++){var h=o[a];s(i,n,h(i,n,r(i,n)))}return t}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=i;var s=Object.defineProperty,r=Object.getOwnPropertyDescriptor;t.exports=e["default"]},568:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e,i,s,r){var n={};return Object.keys(s).forEach(function(t){n[t]=s[t]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce(function(i,s){return s(t,e,i)||i},n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(t,e,n),n=null),n}e.__esModule=!0,e["default"]=void 0;var o,a=i(339),l=i(569),h=s(l),u=i(570),p=s(u),d=i(573),c=s(d),f=i(579),v=s(f),g=i(586),m=s(g),y=i(597),w=s(y),b=i(600),T=s(b),x=function(){var t=void 0,e=document.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in i)if(void 0!==e.style[t])return i[t]},E=(o=function(){function t(e){r(this,t),this.$win=$(window),this.$body=$("body"),this.$el=$(".creation-tools"),this.$help=this.$el.find(".help-callout"),this.$page=this.$el.find(".creation-tools-page"),this.$welcome=this.$el.find(".creation-tools-welcome"),this.$mainGrid=this.$el.find(".creation-tools-main"),this.$mainMenu=this.$el.find(".creation-tools-menu"),this.$showHelp=this.$el.find(".show-help"),this.$hideHelp=this.$el.find(".hide-help"),this.$helpDetails=this.$el.find(".help-details"),this.$backToTop=this.$helpDetails.find(".back-to-top"),this.$featuredGifs=this.$el.find(".featured-gifs"),this.subviews={},this.transitionEnd=x(),this.isBusy=!1,this.isOpen=!1,this.submitUrl="",this.featuredGifs=[],this.creationType="",this.branded="",this.defaultTags="",this.beforeLeaveMessage="You're going to abandon this sweet GIF!",this.options=e||{},this.submitUrl=this.options.submitUrl||"",this.featuredGifs=_.isString(this.options.featuredGifs)?JSON.parse(this.options.featuredGifs):[],this.creationType=this.options.creationType||"",this.branded=this.options.branded||"",this.defaultTags=this.options.defaultTags||"",Giphy.Events.on("creationtools:condensemenu",_.bind(this.condenseMenu,this)),Giphy.Events.on("creationtools:expandmenu",_.bind(this.expandMenu,this)),Giphy.Events.on("optionalfields:complete",_.bind(this.__uploadComplete,this)),Giphy.Events.on("fileportal:success",_.bind(this.__uploadComplete,this)),Giphy.CreationTools=this,this.render()}return t.prototype.__onScroll=function(){var t=this.$win.scrollTop(),e=this.$helpDetails.offset().top,i=e+this.$helpDetails.height();t>e&&t<i?this.$backToTop.show():this.$backToTop.hide()},t.prototype.__beforeUnload=function(t){if(this.isBusy)return t=t||window.event,t&&(t.returnValue=this.beforeLeaveMessage),this.beforeLeaveMessage},t.prototype.__loginClick=function(){this.isBusy=!1},t.prototype.__uploadComplete=function(){this.isBusy=!1},t.prototype.backToTop=function(){var t=this.$helpDetails.offset().top;$("html, body").animate({scrollTop:t},200)},t.prototype.condenseHelp=function(t){t.preventDefault(),this.$showHelp.show(),this.$hideHelp.hide(),this.$helpDetails.hide()},t.prototype.expandHelp=function(){this.$showHelp.hide(),this.$hideHelp.show(),this.$helpDetails.show()},t.prototype.condenseMenu=function(){if(!this.isOpen){this.isBusy=!0,this.isOpen=!0;var t=_.bind(function(){this.$el.hasClass("hide-welcome")||(this.$el.addClass("hide-welcome is-hiding-welcome"),this.$welcome.one(this.transitionEnd,_.bind(function(){this.$el.addClass("content-open").removeClass("is-hiding-welcome")},this)))},this);this.$mainGrid.length?$("html, body").animate({scrollTop:this.$mainGrid.offset().top-5},200,t):t(),this.subviews.featuredGifs&&this.subviews.featuredGifs.hide()}},t.prototype.expandMenu=function(){this.isOpen&&(this.isBusy=!1,this.isOpen=!1,this.$el.addClass("is-hiding-welcome").removeClass("hide-welcome"),this.$welcome.one(this.transitionEnd,_.bind(function(){this.$el.removeClass("is-hiding-welcome content-open")},this)),this.subviews.featuredGifs&&this.subviews.featuredGifs.show())},t.prototype.render=function(){if(this.$el.length){this.subviews.optionalFields=new p["default"]({method:this.creationType.replace("_","")});var t=this.options.featuredSearches?JSON.parse(this.options.featuredSearches):null,e={optionalFields:this.subviews.optionalFields,submitUrl:this.submitUrl};switch(this.creationType){case"upload":this.subviews.upload=new c["default"]({el:this.$el.find(".upload-page"),submitUrl:this.submitUrl});break;case"gif_maker":this.subviews.gifMaker=new m["default"](_.extend({},e,{el:this.$el.find(".gif-maker-page"),defaultTags:this.defaultTags}));break;case"slideshow":this.subviews.slideshow=new v["default"](_.extend({},e,{el:this.$el.find(".create-slideshow-page")}));break;case"gif_caption":this.subviews.gifCaption=new w["default"](_.extend({},e,{el:this.$el.find(".create-caption-page")}));break;case"gif_editor":this.subviews.gifEditor=new T["default"](_.extend({},e,{el:this.$el.find(".create-editor-page"),featuredSearches:t}))}_.isEmpty(this.featuredGifs)||(this.subviews.featuredGifs=new h["default"]({el:this.$featuredGifs,gifs:this.featuredGifs})),this.branded||(this.$win.on("beforeunload.creation-tools",_.bind(this.__beforeUnload,this)),this.$body.on("click.creation-tools","#login-button",_.bind(this.__loginClick,this)),this.$win.on("scroll.creation-tools",_.bind(this.__onScroll,this)),this.$showHelp.on("click",_.bind(this.expandHelp,this)),this.$hideHelp.on("click",_.bind(this.condenseHelp,this)),this.$backToTop.on("click",_.bind(this.backToTop,this)))}},t.prototype.remove=function(){_.each(this.subviews,function(t){t.remove(),t=null})},t}(),n(o.prototype,"__onScroll",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"__onScroll"),o.prototype),n(o.prototype,"__beforeUnload",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"__beforeUnload"),o.prototype),n(o.prototype,"__loginClick",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"__loginClick"),o.prototype),n(o.prototype,"__uploadComplete",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"__uploadComplete"),o.prototype),o);e["default"]=E},569:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),this.template=_.template(['<div class="featured-gifs-container">',"<% _.each(gifs, function(gif, i) { %>",'<a class="featured-gif <%- gif.class_name %>" href="<%- gif.permalink_url %>" target="_blank">','<span class="featured-index"><%- i + 1 %></span>','<img class="featured-gif-image" src="<%- gif.image_url %>" />',"<% if (i === 2) { %>",'<div class="layer layer-2">','<img class="featured-gif-image" src="<%- gif.image_url %>" />',"</div>",'<div class="layer layer-3">','<img class="featured-gif-image" src="<%- gif.image_url %>" />',"</div>","<% } %>","</a>","<% }); %>","</div>"].join("")),this.options=e||{},this._configure(),this.render()}return t.prototype._configure=function(){this.$el=$(this.options.el||""),this.gifs=this.options.gifs,this.maxGifs=this.options.maxGifs||5},t.prototype.render=function(){this.$el.length&&!_.isEmpty(this.gifs)&&(this.gifs=_.shuffle(this.gifs),_.each(this.gifs,function(t,e){var i="featured-"+(e+1);i+=0===e||1===e||3===e?" grid_3":" grid_5",t.class_name=i}),this.$el.append(this.template({gifs:_.first(this.gifs,this.maxGifs)})),this.show())},t.prototype.show=function(){this.$el.length&&this.$el.show()},t.prototype.hide=function(){this.$el.length&&this.$el.hide()},t.prototype.remove=function(){},t}();e["default"]=s},570:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(571),o=s(n),a=i(572),l=s(a),h=function(){function t(e){return r(this,t),e=e||{},this.$win=$(window),this.$body=$("body"),this.$el=$("#optional-fields"),this.progressBar=null,this.user=null,this.method=e.method,this.isError=!1,this.processingGifIds=[],this.isRatingEnabled=!1,this.render(),this}return t.prototype.__uploadClick=function(t){return t.preventDefault(),this.$termsField.get(0).checked?(this.$loadingGlass.show(),this.$uploadButton.hide(),this.$uploadProgressContainer.show(),this.$reverseButton.hide(),this.$container.addClass("uploading"),void Giphy.Events.trigger("optionalfields:upload")):void o["default"].show("ACCEPT_TOS")},t.prototype.__pauseClick=function(t){t.preventDefault(),this._reset(!0),this.$uploadButton.text("Paused - Resume Upload"),Giphy.Events.trigger("optionalfields:pause")},t.prototype.__privacyToggle=function(t,e){this.$isHidden.val(e?0:1)},t.prototype.__ratingChange=function(t,e){this.isRatingEnabled&&Giphy.Events.trigger("optionalfields:ratingchange",e)},t.prototype.__channelSelectorChange=function(t){Giphy.Events.trigger("optionalfields:channelchange",t?t.id:"")},t.prototype.__loginCheck=function(t){t.target.IS_STAFF&&(this.$usernameField.attr("type","text"),_.has(Giphy,"renderChannelSelector")&&this.$addToChannel.length&&Giphy.renderChannelSelector(this.$addToChannel.get(0),{isDark:!0,onSave:_.bind(this.__channelSelectorChange,this)})),(t.target.IS_STAFF||t.target.IS_PARTNER||t.target.IS_ARTIST)&&(this.isRatingEnabled=!0,this.$gifRating.show()),t.target.LOGGED_IN&&(this.$privacyToggle.show(),Giphy.Events.trigger("optionalfields:loggedIn")),t.target.USER&&(this.user=t.target.USER,this.user.isStaff=t.target.IS_STAFF)},t.prototype.__almostComplete=function(){this.$uploadProgressContainer.find(".upload-pause").hide()},t.prototype.__progress=function(t,e){e=e||{},"slideshow"===this.method||"gifmaker"===this.method||"gifcaption"===this.method?(this.progressBar.updateWithText("Creating your GIF",.85*e.totalProgress,1),100===e.totalProgress&&this.progressBar.updateWithText("Creating your GIF",99,e.estimatedTime)):(this.progressBar.updateWithText("Uploading "+e.currentFile+" of "+e.totalFiles,.85*e.totalProgress,1),100===e.totalProgress&&this.progressBar.updateWithText("Preparing your GIFs",99,e.estimatedTime))},t.prototype.__complete=function(t,e){if(Giphy.Events.trigger("optionalfields:complete"),e.totalFiles>1&&this.user){var i;i=this.user.isStaff&&this.$usernameField.val()?"/channel/"+this.$usernameField.val():this.user.channel,i?(this.progressBar.completeWithText("Upload complete! Go to your channel page",_.bind(this._completed,this)),this.$uploadProgressContainer.css("cursor","pointer").on("click",function(){window.open(i)})):this.progressBar.completeWithText("Upload complete!");
}else e.firstFile&&e.firstFile.giphy_url?(this.progressBar.completeWithText("Upload complete!"),window.location=e.firstFile.giphy_url):this.progressBar.completeWithText("Upload process finished with some errors",_.bind(this._completed,this))},t.prototype.__processingFile=function(t,e){var i=this.processingGifIds.indexOf(e.id)>-1;e.isComplete&&i?this.processingGifIds=_.without(this.processingGifIds,e.id):i||this.processingGifIds.push(e.id),this.$el.toggleClass("processing-gifs",this.processingGifIds.length>0)},t.prototype.__serverError=function(t,e){this.isError=!0,this.progressBar.reset(),this._reset(),this._showButtonError(e.message||"Uh-oh. Something went wrong.")},t.prototype.__buttonError=function(t,e){e&&this._showButtonError(e)},t.prototype.__buttonReset=function(){this._resetButtonMessage()},t.prototype.__updateFiles=function(t,e){this.$uploadButton.toggleClass("disabled",!e.hasEnough),this.isError&&(this._reset(),this.isError=!1)},t.prototype._reset=function(t){this.$loadingGlass.hide(),this.$uploadProgressContainer.hide(),this.$uploadButton.removeClass("error").show().text(this.$uploadButton.data("label")),t||(this.$container.removeClass("uploading"),this.$reverseButton.show())},t.prototype._completed=function(){this.$container.addClass("upload-complete")},t.prototype._showButtonError=function(t){this.$uploadButton.addClass("error").text(t)},t.prototype._showButtonMessage=function(t,e){var i=this.$uploadButton.data("label");this.$uploadButton.text(e?i+" "+t:t)},t.prototype._resetButtonMessage=function(){this.$uploadButton.removeClass("error").text(this.$uploadButton.data("label"))},t.prototype.cacheSelectors=function(){this.$isHidden=this.$el.find("#is-hidden"),this.$privacyToggle=this.$el.find("#privacy-toggle").hide(),this.$usernameField=this.$el.find("#username"),this.$tagsField=this.$el.find("#tags"),this.$sourcePostUrl=this.$el.find("#source-post-url"),this.$termsField=this.$el.find(".agree-to-terms"),this.$loadingGlass=this.$el.find(".create-loading-glass"),this.$uploadButton=this.$el.find("#upload-gif-button"),this.$uploadProgressContainer=this.$el.find(".upload-progress-container"),this.$container=$(".creation-tools"),this.$reverseButton=$("#reverse-button"),this.$gifRating=$(".gif-rating"),this.$addToChannel=this.$el.find(".add-to-channel")},t.prototype.render=function(){this.$el.length&&(this.cacheSelectors(),this.$uploadButton.data("label",this.$uploadButton.text()),this.progressBar=new l["default"](this.$el.find(".create-progress-bar")),this.$el.on("click.optional-fields","#upload-gif-button",_.throttle(_.bind(this.__uploadClick,this),300,{trailing:!1})),this.$el.on("toggle.optional-fields","#privacy-toggle",_.bind(this.__privacyToggle,this)),this.$el.on("click.optional-fields",".upload-pause",_.bind(this.__pauseClick,this)),this.$el.on("change.optional-fields",".gif-rating .radio-options",_.bind(this.__ratingChange,this)),this.$win.on("login:check.optional-fields",_.bind(this.__loginCheck,this)),Giphy.Events.on("sortable:cancelClick",this._reset,this),Giphy.Events.on("fileportal:update",this.__updateFiles,this),Giphy.Events.on("fileportal:cancel",this._reset,this),Giphy.Events.on("fileportal:progress",this.__progress,this),Giphy.Events.on("fileportal:almostComplete",this.__almostComplete,this),Giphy.Events.on("fileportal:complete",this.__complete,this),Giphy.Events.on("fileportal:serverError",this.__serverError,this),Giphy.Events.on("uploadbutton:error",this.__buttonError,this),Giphy.Events.on("uploadbutton:reset",this.__buttonReset,this),Giphy.Events.on("slideshow:processing",this.__processingFile,this))},t.prototype.remove=function(){this.$el.length&&(this.$el.off(".optional-fields"),this.$win.off(".optional-fields"))},t}();e["default"]=h},571:function(t,e){"use strict";e.__esModule=!0,e["default"]={messageStrings:{MAX_NUM_FILES:"Maximum number of files reached.",FILE_TOO_BIG:"Uh-oh! Some files were too big.",LOGIN_FOR_MULTIPLE_FILES:"To upload multiple GIFs at once you must be logged in. If you don't log in, you can upload one by one.",VIDEO_TOO_LONG:"Oops! Shorter GIFs are better GIFs.",ACCEPT_TOS:"Please accept our Terms of Service to continue.",INVALID_URL:"Please enter a valid URL.",INVALID_FILE:"Whoops! Some files were invalid.",INVALID_VIDEO:"Whoops! Your browser does not support this video.",SOMETHING_WENT_WRONG:"Uh-oh. Something went wrong. Please try again or contact support@giphy.com.",DUPLICATE_FILE:"Oops! You've already added that file.",DUPLICATE_URL:"URL already in upload queue.",MAX_TOTAL_FILESIZE:"Oops! You’ve reached the maximum file size.",VIDEO_BLOCKED:"Sorry! This video has been blocked on copyright grounds.",UNSUPPORTED_URL:"Sorry! We do not support this video url.",CC_EPISODE_ERROR:"Oops! We don't accept full episodes from Comedy Central right now. Please try a video clip instead."},show:function(t,e){var i=this.messageStrings[t]||t,s=e||"";return window.showError(i+" "+s),i+" "+s},showDurationError:function(t,e){var i="Your "+t+" is";return e&&(i+=" "+e),i+=" too long! Edit and try again!",window.showError(i),i},showResolved:function(){var t="You're good!";return window.showSuccess(t),t}}},572:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),this.$el=$(e),this.$progress=$('<div class="progress"></div>'),this.$stripes=$('<div class="stripes"></div>'),this.$text=$('<div class="text"></div>'),this.animationEnd="animationend webkitAnimationEnd oAnimationEnd msAnimationEnd",this.transitionTimeout=null,this.percent=0,this.render()}return t.prototype.render=function(){this.$el.append(this.$text),this.$el.append(this.$progress),this.$progress.append(this.$stripes),this.$el.addClass("timed-progress-bar")},t.prototype.updateWithText=function(t,e,i,s){this.percent=e,this.transitionTimeout&&clearTimeout(this.transitionTimeout),this.$progress.addClass("notransition"),this.$progress.css({transition:"width "+i+"s","-webkit-transition":"width "+i+"s","-o-transition":"width"+i+"s","-ms-animation":"width"+i+"s"}),this.$progress[0].offsetHeight,this.$progress.removeClass("notransition"),e=Math.max(0,Math.min(Math.round(e),100)),this.$progress.css("width",e+"%"),this.$text.text(t),this.$el.removeClass("complete"),this.transitionTimeout=setTimeout(_.bind(function(){100===e?this.$el.addClass("complete").one(this.animationEnd,_.bind(function(){s&&s()},this)):s&&s()},this),1e3*i)},t.prototype.getProgress=function(){return this.percent},t.prototype.completeWithText=function(t,e,i){i=_.isUndefined(i)?1:i,this.updateWithText(t,100,i,e)},t.prototype.update=function(t,e,i){this.updateWithText("",t,e,i)},t.prototype.complete=function(t,e){this.completeWithText("",t,e)},t.prototype.reset=function(){this.update(0,0),this.$el.removeClass("complete")},t}();e["default"]=s},573:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(574),o=s(n),a=function(){function t(e){r(this,t),this.$win=$(window),this.$el=$(".creation-tools-upload"),this.$footer=this.$el.find(".tool-footer"),this.user=null,this.fileportal=null,this.fileTypes=["image/gif",".mp4",".mov"],this.submitUrl=e.submitUrl||"",this.render()}return t.prototype.__submit=function(){this.filePortal.submit()},t.prototype.__loginCheck=function(t){t.target.LOGGED_IN?this.$footer.hide():this.$footer.show()},t.prototype.render=function(){this.$el.length&&(this.filePortal=new o["default"]({url:this.submitUrl,fileTypes:this.fileTypes,sortableList:this.$el.find("#upload-queue"),allowAnonymous:!1,multipleRequiresLogin:!0,maxVideoLength:15,defaultTags:"giphyupload",preventDuplicates:!0}),this.$win.on("login:check.upload-gif",_.bind(this.__loginCheck,this)),Giphy.Events.on("optionalfields:upload.upload-gif",this.__submit,this))},t}();e["default"]=a},574:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(571),o=s(n),a=i(575),l=s(a),h=i(577),u=s(h),p=function(){function t(e){r(this,t),this.mimeTypes={"image/*":/\.(jpe?g|png|gif|bmp)$/i,"image/gif":/\.(gif)$/i,"image/jpeg":/\.(jpe?g)$/i,"image/png":/\.(png)$/i,"video/*":/\.(mpeg|mp4|m4v|mov)$/i,"video/mpg":/\.(mpeg)$/i,"video/mpeg":/\.(mpeg)$/i,"video/mp4":/\.(mp4)$/i,"video/m4v":/\.(m4v)$/i,"video/x-m4v":/\.(m4v)$/i,"video/mov":/\.(mov)$/i,"video/quicktime":/\.(mov)$/i,".mp4":/\.(mp4)$/i,".mov":/\.(mov)$/i},e=e||{},this.$el=$(".file-portal"),this.$urlInput=$(),this.uploadUrl=e.url,this.fileTypes=e.fileTypes||["image/gif"],this.sortableList=e.sortableList,this.uploadMultiple=e.uploadMultiple||!1,this.maxFiles=e.maxFiles||500,this.minFiles=e.minFiles||1,this.parallelUploads=e.parallelUploads||1,this.maxFilesize=e.maxFilesize||100,this.maxTotalFilesize=e.maxTotalFilesize||-1,this.maxVideoLength=e.maxVideoLength||!1,this.multipleRequiresLogin=e.multipleRequiresLogin||!1,this.allowAnonymous=!_.isBoolean(e.allowAnonymous)||e.allowAnonymous,this.defaultTags=e.defaultTags||"",this.preventDuplicates=e.preventDuplicates||!1,this.replaceFile=e.replaceFile||!1,this.subviews={},this.fileQueue=[],this.fileQueueTimeout=null,this.fileTypesInEnglish=this._fileTypesInEnglish(),this.gifRating="",this.channelID="",this.parentView=e.parentView,this.inputDelay=null,this.isLoggedIn=!1,this.isCanceled=!1,this.isUploading=!1,this.fileTypes=_.isString(this.fileTypes)?this.fileTypes.split(" "):this.fileTypes,this.render()}return t.prototype.__acceptFile=function(t,e){t=t||{},clearTimeout(this.fileQueueTimeout),this.fileQueue.push(t),this.fileQueueTimeout=setTimeout(_.bind(this.__validateFiles,this),100),e()},t.prototype.__dropUrl=function(t,e){if(e){var i=this._validateUrl(e);i&&this._checkFile(i,!0)}},t.prototype.__validateFiles=function(){var t=[];_.each(this.fileQueue,_.bind(function(e){t.push(this._checkFile(e))},this)),$.when.apply($,t).done(_.bind(function(){this.fileQueue=[],_.each(arguments,_.bind(function(t){t.isValid?this._addToFiles(t.file):t.errorShown||o["default"].show("INVALID_FILE")},this))},this))},t.prototype.__removeFile=function(t){t&&"url"!==t.type&&this.subviews.dropzone&&this.subviews.dropzone.removeFile(t),this.update(),Giphy.Events.trigger("fileportal:removed",t)},t.prototype.__ratingChange=function(t,e){this.gifRating=e||""},t.prototype.__channelChange=function(t,e){this.channelID=e||""},t.prototype.__dropzoneError=function(t,e,i){this.subviews.files.length()>=this.maxFiles?o["default"].show("MAX_NUM_FILES"):t.size/1048576>this.maxFilesize?(this._showError(t,"This file must be "+this.maxFilesize+" MB or less."),o["default"].show("FILE_TOO_BIG","This tool supports files up to "+this.maxFilesize+" MB.")):i?(t.status="queued",this.serverError("SOMETHING_WENT_WRONG","Oops! Something went wrong")):(this._showError(t,"This file is invalid."),o["default"].show("INVALID_FILE","This tool supports "+this.fileTypesInEnglish+"."))},t.prototype.__fileError=function(t,e){o["default"].show(t,e)},t.prototype.__progress=function(t,e){var i=this.subviews.files;if(i){var s=30,r=i.length(),n=i.nextIndex,o=(e/100+n-1)/r*100;Giphy.Events.trigger("fileportal:progress",{currentFile:n,currentFileName:t.name,progress:e,totalFiles:r,totalProgress:o,estimatedTime:s})}},t.prototype.__success=function(t,e){if(_.isUndefined(e)||_.isNull(e))return void o["default"].show("SOMETHING_WENT_WRONG");_.isString(e)&&(e=$.parseJSON(e));var i=e.meta.status;return 200===i?e.data&&e.data.id?void(window.isGifys?($("#upload-gif-form").hide(),$("#gifys-submission-complete").show()):window.IS_PARTNER||window.IS_ARTIST||!window.LOGGED_IN?this._showSuccess(t,e.data.id,"/gifs/"+e.data.id):this._showSuccess(t,e.data.id,"/gifs/"+e.data.id+"?status=200")):(o["default"].show("SOMETHING_WENT_WRONG"),void this._showError(t,e.data.msg)):400===i?void this._showError(t,e.meta.msg):401===i?void(window.location=window.location+"?status=401"):409===i?void(window.IS_PARTNER||window.IS_ARTIST||!window.LOGGED_IN?this._showSuccess(t,e.data.id,"/gifs/"+e.data.id):this._showSuccess(t,e.data.id,"/gifs/"+e.data.id+"?status=409")):480===i?void(window.location="/480"):i>=500?(o["default"].show("SOMETHING_WENT_WRONG"),void this._showError(t,"Error: unknown error")):void this._showError(t,"Error: "+e.meta.msg)},t.prototype.__complete=function(t){t.accepted&&this._processNextUpload()},t.prototype.__pause=function(){this.isCanceled=!0},t.prototype.__cancel=function(t,e){this.subviews.files&&this.subviews.files.removeById(e,!0)},t.prototype.__urlInput=function(){var t=this.$urlInput.val(),e=this._validateUrl(t);if(clearTimeout(this.inputDelay),e){var i=_.bind(this._checkFile,this);this.inputDelay=_.delay(i,500,e,!0)}},t.prototype.__urlKeydown=function(t){if(13===t.which){t.preventDefault(),t.stopPropagation();var e=this.$urlInput.val(),i=this._validateUrl(e);return clearTimeout(this.inputDelay),i?this._checkFile(i,!0):o["default"].show("INVALID_URL"),!1}},t.prototype.__hasMenu=function(){return Giphy.CreationTools&&!Giphy.CreationTools.branded},t.prototype._validateUrl=function(t){if(t=t.trim(),!t)return!1;if(/^(ftp|http|https)/.test(t)||(t="http://"+t),!/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t))return!1;var e=Giphy.Utils.urlRE.exec(t),i=!1,s=this.fileTypes.indexOf("image/*")>-1||this.fileTypes.indexOf("image/gif")>-1,r=t;if(!e)return!1;t=e[1];var n=_.last(t.split("."));"gifv"===n&&(t=t.replace(".gifv",".gif"));var a=t.replace("http://","").replace(/.*?:\/\//g,""),l=a.match(/giphy\.com\/gifs\/.*|gph\.is\/.*/i);if(s&&!_.isEmpty(l)){var h=_.last(l).split("/"),u=_.last(h);return"https://media.giphy.com/media/"+_.last(u.split("-"))+"/giphy.gif"}var p=Giphy.Utils.isGifmakerUrl(t);return _.each(this.fileTypes,_.bind(function(e){if(i||"youtube"!==e)if(i||"vimeo"!==e){if(!i&&"gifmakerwhitelist"===e&&p)p.indexOf("error")>-1?o["default"].show(p.toUpperCase()):i=t;else if(!i&&_.has(this.mimeTypes,e)){var s=this.mimeTypes[e];s.test(a)&&(i=r)}}else{var n=Giphy.Utils.getVimeoId(r);i=!!n&&"vimeoId="+n}else{var l=Giphy.Utils.getYoutubeId(r);i=!!l&&"youtubeId="+l}},this)),i},t.prototype._validateFile=function(t){var e=$.Deferred(),i=this.maxVideoLength,s=!1,r=!1;return _.isString(t)?(s=this.mimeTypes["video/*"].test(t),r=this.mimeTypes["image/*"].test(t)):_.isObject(t)&&(s=t.type&&t.type.indexOf("video")>-1,r=t.type&&t.type.indexOf("image")>-1),this.maxVideoLength&&s?this._validateVideo(t).fail(function(){e.reject()}).done(function(t){if(t&&Math.floor(t)<=i)e.resolve();else{var s=Giphy.Utils.formatTimeObject(i),r="";s.h&&(r.length&&(r+=", "),r+=s.h+" hours"),s.m&&(r.length&&(r+=", "),r+=s.m+" minutes"),s.s&&(r.length&&(r+=", "),r+=s.s+" seconds"),o["default"].show("VIDEO_TOO_LONG","Please upload videos under "+r+"."),e.reject(!0)}}):r&&_.isString(t)?e.resolve():e.resolve(),e.promise()},t.prototype._validateImageUrl=function(t){var e=$.Deferred();return t&&_.isString(t)?Giphy.Utils.preloadImage(t).done(function(){e.resolve()}).fail(function(){e.reject()}):e.reject(),e.promise()},t.prototype._validateVideo=function(t){var e=$.Deferred();return t&&this.maxVideoLength?Giphy.Utils.getVideoDuration(t).fail(function(){e.resolve(1)}).done(function(t){e.resolve(t)}):e.resolve(),e.promise()},t.prototype._getRequestParams=function(t){var e=this.defaultTags;_.isEmpty($("#tags").val())||(e+=","+$("#tags").val());var i={session_key:$.cookie("giphy_session_id")||"",api_key:Giphy.CreationApiHelper.apiKey,tags:e,source_post_url:$("#source-post-url").val(),source_image_url:$("#gif-url").val(),username:$("#username").val(),is_hidden:$("#is-hidden").val(),rating:this.gifRating,channel_id:this.channelID};return"undefined"!=typeof t&&(i.source_image_url=t),i},t.prototype._checkFile=function(t,e){if(t&&this.subviews.files){var i=$.Deferred();return this._validateFile(t).fail(function(e){i.resolve({file:t,isValid:!1,errorShown:e||!1})}).done(_.bind(function(){i.resolve({file:t,isValid:!0}),e&&this._addToFiles(t)},this)),i.promise()}},t.prototype._addToFiles=function(t){if(t&&this.subviews.files){1===this.maxFiles&&this.replaceFile&&this.subviews.files.empty();var e=this.subviews.files.append(t),i=this.subviews.files.length();e&&(this.update(),"url"===e.type&&(this.$urlInput.val(""),this.$el.addClass("success"),setTimeout(_.bind(function(){this.$el.removeClass("success")},this),1e3)),_.delay(_.bind(function(){Giphy.Events.trigger("fileportal:added",e)},this),i>1?0:1800))}},t.prototype._allDone=function(){this.isUploading=!1,Giphy.Events.trigger("fileportal:complete",{firstFile:this.subviews.files.get(0),totalFiles:this.subviews.files.length()})},t.prototype._processNextUpload=function(){if(this.isCanceled||!this.subviews.files)return this.isCanceled=!1,void(this.isUploading=!1);var t=this.subviews.files.nextAvailable();return t?(this.subviews.files.hasNext()||Giphy.Events.trigger("fileportal:almostComplete"),"url"===t.type?(t.status="processing",this._uploadUrl(t)):this.subviews.dropzone.processFile(t),this.isUploading=!0,void Giphy.Events.trigger("fileportal:processing",{file:t})):void this._allDone()},t.prototype._uploadUrl=function(t){if(t){var e=this,i=this._getRequestParams(t.name);$.ajax({beforeSend:function(t){t.setRequestHeader("")},url:this.uploadUrl,type:"POST",cache:!1,timeout:72e4,data:i}).done(function(i){e.__progress(t,100),e.__success(t,i)}).fail(function(i,s){e._showError(t,"Error: "+s),o["default"].show("SOMETHING_WENT_WRONG")}).always(function(){e._processNextUpload()})}},t.prototype._showSuccess=function(t,e,i){t&&(t.status="success",t.giphy_url=i,Giphy.Events.trigger("fileportal:success",{file:t,gifId:e,url:i}))},t.prototype._showError=function(t,e){t&&(t.status="error",Giphy.Events.trigger("fileportal:error",{file:t,message:e}))},t.prototype.render=function(){this.$el.length&&(this.$urlInput=this.$el.find(".url-input"),this.subviews.dropzone=new u["default"]({url:this.uploadUrl,params:{api_key:Giphy.CreationApiHelper.apiKey},method:"post",headers:{"Cache-Control":null},clickable:".browse",maxFilesize:this.maxFilesize,maxFiles:1===this.maxFiles&&this.replaceFile?null:this.maxFiles,parallelUploads:this.parallelUploads,uploadMultiple:this.uploadMultiple,autoProcessQueue:!1,acceptedFiles:_.without(this.fileTypes,"youtube","vimeo","gifmakerwhitelist").join(","),addedfile:$.noop,accept:_.bind(this.__acceptFile,this),error:_.bind(this.__dropzoneError,this),success:_.bind(this.__success,this),complete:_.bind(this.__complete,this),uploadprogress:_.bind(this.__progress,this)}),this.subviews.files=new l["default"]({multipleRequiresLogin:this.multipleRequiresLogin,maxFiles:this.maxFiles,maxTotalFilesize:this.maxTotalFilesize,sortable:this.sortableList?$(this.sortableList):null,remove:_.bind(this.__removeFile,this),error:_.bind(this.__fileError,this),preventDuplicates:this.preventDuplicates}),this.__hasMenu()&&(this.$el.on("input.file-portal",".url-input",_.bind(this.__urlInput,this)),this.$el.on("keydown.file-portal",".url-input",_.bind(this.__urlKeydown,this))),Giphy.Events.on("sortable:cancelClick",this.__cancel,this),Giphy.Events.on("optionalfields:pause",this.__pause,this),Giphy.Events.on("optionalfields:ratingchange",this.__ratingChange,this),Giphy.Events.on("optionalfields:channelchange",this.__channelChange,this),Giphy.Events.on("dropzone:urlDrop",this.__dropUrl,this))},t.prototype.isOnlyGifs=function(){if(this.subviews.files)return this.subviews.files.isOnlyGifs()},t.prototype.update=function(){if(this.subviews.files){var t=this.subviews.files.length();Giphy.Events.trigger("fileportal:update",{fileCount:t,hasEnough:t>=this.minFiles}),1===t&&this.__hasMenu()?Giphy.Events.trigger("creationtools:condensemenu"):0===t&&Giphy.Events.trigger("creationtools:expandmenu")}},t.prototype.submit=function(){return this.subviews.files&&this.subviews.files.length()?(this.subviews.dropzone&&(this.subviews.dropzone.options.params=this._getRequestParams(),this._processNextUpload()),void Giphy.Events.trigger("fileportal:submit")):void Giphy.Events.trigger("fileportal:cancel")},t.prototype.files=function(){return this.subviews.files},t.prototype.dropzone=function(){return this.subviews.dropzone},t.prototype.remove=function(){this.$el.length&&(this.$el.off(".file-portal"),_.each(this.subviews,function(t){t.remove()}),this.subviews={})},t.prototype._fileTypesInEnglish=function(){var t=[];this.fileTypes.indexOf("image/*")>-1?t.push("image"):(this.fileTypes.indexOf("image/gif")>-1&&t.push("GIF"),this.fileTypes.indexOf("image/jpeg")>-1&&t.push("JPEG"),this.fileTypes.indexOf("image/png")>-1&&t.push("PNG")),this.fileTypes.every(function(e){if(0===e.indexOf("."))t.push(e.replace(".","").toUpperCase());else if(e.indexOf("video")>-1)return t.push("video"),!1;return!0});var e="";return e+=t.length>1?t.slice(0,-1).join(", ")+" and "+t.slice(-1)[0]+" files":t[0]+" files"},t.prototype.serverError=function(t,e){o["default"].show(t),Giphy.Events.trigger("fileportal:serverError",{message:e})},t}();e["default"]=p},575:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(576),o=s(n),a=function(){this.move=function(t,e){this.splice.apply(this,[e,0].concat(this.splice(t,1)))},this.pop=function(t){return this.splice(t,1)[0]}};a.prototype=Array.prototype;var l=function(){function t(e){return r(this,t),e=e||{},this.$win=$(window),this.$sortable=$(e.sortable||""),this.files=new a,this.nextIndex=null,this.maxFiles="undefined"!=typeof e.maxFiles?e.maxFiles:1e3,this.errorHandler="undefined"!=typeof e.error?e.error:this.__errorHandler,this.removeHandler="undefined"!=typeof e.remove?e.remove:this.__removeHandler,this.multipleRequiresLogin="undefined"!=typeof e.multipleRequiresLogin&&e.multipleRequiresLogin,this.maxTotalFilesize="undefined"!=typeof e.maxTotalFilesize?e.maxTotalFilesize:-1,this.hasSortable=!1,this.isLoggedIn=!1,this.totalFilesize=0,this.preventDuplicates=e.preventDuplicates||!1,this.$win.on("login:check.file-manager",_.bind(this.__loginCheck,this)),Giphy.Events.on("sortable:reverse",_.bind(this.reverse,this)),this.render(),this}return t.prototype.__loginCheck=function(t){this.isLoggedIn=t.target.LOGGED_IN},t.prototype.__errorHandler=function(){},t.prototype.__removeHandler=function(){},t.prototype.__sortableUpdate=function(t,e){var i=e.item.attr("id"),s=this.$sortable.find("li").index(e.item);this.move(i,s)},t.prototype.render=function(){null!==this.$sortable&&(this.sortable=new o["default"]({el:this.$sortable,update:$.proxy(this.__sortableUpdate,this),disabled:!0}),this.hasSortable=!0)},t.prototype._checkFiles=function(){return this.multipleRequiresLogin&&this.length()>=1&&!this.isLoggedIn?(this.errorHandler("LOGIN_FOR_MULTIPLE_FILES"),!1):!(this.length()>this.maxFiles&&(this.errorHandler("MAX_NUM_FILES"),1))},t.prototype._appendFile=function(t){if(!this._checkFiles())return null;if(t.id=window.btoa(t.name+t.lastModified).replace(/=/g,""),this.preventDuplicates&&this.index(t.id)>-1)return this.errorHandler("DUPLICATE_FILE"),null;if(t.size){var e=this.totalFilesize+t.size/1048576;if(this.maxTotalFilesize>0&&e>this.maxTotalFilesize)return this.length()<1?this.errorHandler("FILE_TOO_BIG"):this.errorHandler("MAX_TOTAL_FILESIZE",this.maxTotalFilesize+"MB."),null;this.totalFilesize=e}return t.index=this.length(),t.status="queued",this.files.push(t),Giphy.Events.trigger("filemanager:addfile",t),t},t.prototype._appendURL=function(t){if(!this._checkFiles())return null;var e="url-"+window.btoa(t).replace(/=/g,"");if(this.preventDuplicates&&this.index(e)>-1)return this.errorHandler("DUPLICATE_URL"),null;var i={id:e,name:t,type:"url",index:this.length(),status:"queued"};return this.files.push(i),Giphy.Events.trigger("filemanager:addurl",i),i},t.prototype._updateSortable=function(){this.hasSortable&&(this.length()<=1?($("#reverse-button").hide(),this.sortable.disable()):($("#reverse-button").show(),this.sortable.enable()))},t.prototype.isOnlyGifs=function(){var t=_.filter(this.files,function(t){var e=t.name.split("?")[0];return t.type.indexOf("image/gif")>-1||e.indexOf(".gif")>-1});return!!t&&t.length===this.files.length},t.prototype.append=function(t){if(!this._checkFiles())return null;var e=void 0;return e=t instanceof File||t instanceof Blob||t instanceof Object?this._appendFile(t):this._appendURL(t),null!==e&&this.hasSortable&&(this.sortable.append(e),this._updateSortable()),e},t.prototype.get=function(t){return this.files[t]},t.prototype.removeAll=function(){var t=this;_.each(this.files,function(e){t.remove(e)})},t.prototype.remove=function(t){Giphy.Events.trigger("filemanager:remove",t);var e=this.files.pop(this.files.indexOf(t));return e.size&&(this.totalFilesize-=e.size/1048576),this.hasSortable&&(this.sortable.trim(t),this._updateSortable()),e},t.prototype.removeById=function(t,e){var i=this.remove(this.files[this.index(t)]);e&&this.removeHandler(i)},t.prototype.empty=function(){_.each(this.files,_.bind(function(t){this.removeById(t.id,!0)},this))},t.prototype.pop=function(t){var e=this.files.pop(this.index(t));return this._updateSortable(),e},t.prototype.index=function(t){return this.files.map(function(t){return t.id}).indexOf(t)},t.prototype.move=function(t,e){this.files.move(this.index(t),e)},t.prototype.length=function(){return this.files.length},t.prototype.nextAvailable=function(){var t=this.cycle();if("undefined"!=typeof t&&"queued"===t.status)return t},t.prototype.hasNext=function(){var t=this.files[this.nextIndex];return!(!t||"undefined"==typeof t)},t.prototype.cycle=function(){(null===this.nextIndex||this.nextIndex>this.files.length-1)&&(this.nextIndex=0);var t=this.files[this.nextIndex];return this.nextIndex++,t},t.prototype.reverse=function(){this.files.reverse(),this.hasSortable&&this.sortable.reverse()},t.prototype.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"===t?e:3&e|8;return i.toString(16)})},t}();e["default"]=l},576:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(572),o=s(n),a=function(){function t(e){r(this,t),this.itemTemplate=_.template(['<li id="<%- id %>" class="sortable-list-item">','<div class="upload-icon">','<div class="upload-cancel button red"><i class="ss-icon ss-delete"></i></div>','<a class="upload-success button blue" href="#" target="_blank"><i class="ss-icon ss-action"></i></a>',"</div>",'<div class="upload-preview"></div>','<div class="upload-progress">','<span class="upload-index"><%- index + 1 %></span>','<span class="upload-label"><%- name %></span>','<div class="progress-bar-container"></div>',"</div>",'<div class="upload-gripper">','<div class="upload-grip"></div>',"</div>","</li>"].join("")),e=e||{},this.$el=$(e.el||".sortable"),this.$body=$("body"),this.placeholder="undefined"!=typeof e.placeholder?e.placeholder:"sortable-placeholder",this.handle="undefined"!=typeof e.handle?e.handle:".upload-gripper",this.disabled="undefined"!=typeof e.disabled&&e.disabled,this.sort="undefined"!=typeof e.sort?e.sort:this.__sort,this.update="undefined"!=typeof e.update?e.update:this.__update,this.progressBars={},this.render()}return t.prototype.__mousedown=function(){this.$el.css("height",this.$el.outerHeight()),this.$body.on("mouseup.sortable",_.bind(this.__mouseup,this))},t.prototype.__mouseup=function(){this.$el.css("height",""),this.$body.off(".sortable")},t.prototype.__reverseClick=function(t){t.preventDefault(),$(t.currentTarget).toggleClass("reversed"),Giphy.Events.trigger("sortable:reverse")},t.prototype.__linkClick=function(t){t.preventDefault();var e=$(t.currentTarget).data("gif-url");e&&window.open(e)},t.prototype.__cancelClick=function(t){t.preventDefault();var e=$(t.currentTarget),i=e.closest(".sortable-list-item");Giphy.Events.trigger("sortable:cancelClick",i.attr("id"))},t.prototype.__stop=function(){_.defer(_.bind(function(){this.$el.find(".sortable-list-item").each(function(){var t=$(this),e=t.find(".upload-index");e.text(t.index()+1)})},this))},t.prototype.__sort=function(t,e){var i=$(this),s=e.helper.outerWidth(),r=e.helper.outerHeight(),n=e.helper[0].className,o=e.placeholder[0].className,a={x:e.position.left+s/2,y:e.position.top+r/2},l=r/2,h=l/4;i.children().each(function(){var t=$(this);if(t.hasClass(n)||t.hasClass(o))return!0;var e={x:t.position().left+s/2,y:t.position().top+r/2},u=Math.sqrt(Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2));if(u<l){var p=e.y-a.y>h,d=e.y-a.y<-h,c=e.x-a.x<-h,f=d||c&&!p;return f?$("."+o,i).insertBefore(t):$("."+o,i).insertAfter(t),!1}})},t.prototype.__remove=function(t){t.preventDefault();var e=$(t.currentTarget).closest("li"),i=e.attr("id");return e.remove(),this.$el.trigger("removeditem",i),i},t.prototype.__update=function(){},t.prototype.__submit=function(){this.disable(),this.$el.find(".upload-gripper").hide()},t.prototype.__processing=function(t,e){var i=this.$el.find("#"+e.file.id);i.length&&i.find(".upload-cancel").hide()},t.prototype.__progress=function(t,e){var i=this.progressBars[e.currentFileName];i&&(i.update(.9*e.progress,1),100===e.progress&&i.update(99,e.estimatedTime))},t.prototype.__processingGif=function(t,e){var i=this.$el.find("#"+e.id+" .progress-bar-container"),s=this.progressBars[e.name];s&&(e.isComplete?s.complete(function(){s.reset(),i.removeClass("processing-gif")}):(s.update(90,10),i.addClass("processing-gif")))},t.prototype.__success=function(t,e){var i=this.$el.find("#"+e.file.id);if(i.length){var s=function(){i.find(".upload-label").text(window.location.host+"/gifs/"+e.gifId),i.find(".upload-success").show(),i.addClass("has-link").data("gif-url",e.url)};_.has(this.progressBars,e.file.name)?this.progressBars[e.file.name].complete(s):s()}},t.prototype.__error=function(t,e){var i=this.$el.find("#"+e.file.id);if(i.length){var s=function(){i.find(".progress-bar-container").addClass("error"),i.find(".upload-label").text(e.message||"Sorry! Upload failed. Try again or contact support@giphy.com")};_.has(this.progressBars,e.file.name)?this.progressBars[e.file.name].complete(s):s()}},t.prototype.render=function(){this.$el.sortable({sort:this.sort,handle:this.handle,update:this.update,disabled:this.disabled,placeholder:this.placeholder,stop:_.bind(this.__stop,this)}),this.$el.on("mousedown.sortable",".sortable-list-item",_.bind(this.__mousedown,this)),this.$el.on("click.sortable",".has-link",_.bind(this.__linkClick,this)),this.$el.on("click.sortable",".upload-cancel",_.bind(this.__cancelClick,this)),$("#reverse-button").on("click.sortable",_.bind(this.__reverseClick,this)),Giphy.Events.on("fileportal:processing",this.__processing,this),Giphy.Events.on("fileportal:progress",this.__progress,this),Giphy.Events.on("fileportal:success",this.__success,this),Giphy.Events.on("fileportal:submit",this.__submit,this),Giphy.Events.on("fileportal:error",this.__error,this),Giphy.Events.on("slideshow:processing",this.__processingGif,this)},t.prototype.append=function(t){t=t||{index:"",name:""};var e=$(this.itemTemplate(t));this.$el.append(e),this.progressBars[t.name]=new o["default"](e.find(".progress-bar-container"))},t.prototype.trim=function(t){if(t){var e=this.$el.find("#"+t.id);e.length&&e.remove(),_.has(this.progressBars,t.name)&&delete this.progressBars[t.name]}},t.prototype.empty=function(){this.$el.empty()},t.prototype.reverse=function(){var t=this.$el.children(),e=t.length;t.each(_.bind(function(t,i){var s=$(i);s.find(".upload-index").text(e-t),this.$el.prepend(s)},this))},t.prototype.enable=function(){this.$el.sortable("enable")},t.prototype.disable=function(){this.$el.sortable("disable")},t}();e["default"]=a},577:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");
}e.__esModule=!0,e["default"]=void 0;var n=i(578),o=s(n),a=function(){function t(e){return r(this,t),this.__dragEnter=_.throttle(function(t){if(t.preventDefault(),t.stopPropagation(),!this.isDisabled)return clearTimeout(this.hoverDelay),this.startDrag(),this.isDragging&&this.powerglove&&this.powerglove.pointTo(t.pageX,t.pageY-this.$win.scrollTop()),!1},20),this.__dragLeave=_.throttle(function(t){if(t.preventDefault(),t.stopPropagation(),!this.isDisabled)return clearTimeout(this.hoverDelay),this.hoverDelay=setTimeout(_.bind(this.stopDrag,this),20),!1},40),this.template=_.template('<div class="drag-drop">\t            <div class="drop-text">Drop files here</div>\t            <div class="drop-image"></div>\t            <div class="powerglove">\t                <div class="glove-inner">\t                    <div class="finger"></div>\t                </div>\t            </div>\t        </div>'),e=e||{},this.$win=$(window),this.$el=$("html"),this.$body=$("body"),this.$drop=$(),this.$dropImage=$(),this.hoverDelay=null,this.dropDelay=null,this.pushPoint={x:0,y:0},this.dropPosition={x:0,y:0},this.addedFileCallback=e.addedfile||$.noop,this.errorCallback=e.error||$.noop,this.transitionEnd=Giphy.Utils.transitionEnd(),this.isDragging=!1,this.isDropping=!1,this.isDisabled=!1,this.powerglove=null,this.dropzone=new window.Dropzone(this.$el.get(0),_.extend(e,{error:_.bind(this.__error,this)})),this.dropzone.on("dragenter",_.bind(this.__dragEnter,this)),this.dropzone.on("dragover",_.bind(this.__dragEnter,this)),this.dropzone.on("dragleave",_.bind(this.__dragLeave,this)),this.dropzone.on("dragend",_.bind(this.__dragLeave,this)),this.dropzone.on("drop",_.bind(this.__drop,this)),this.$body.on("dragstart.fullpage-dropzone","*",_.bind(this.__elementDragStart,this)),this.$body.on("dragend.fullpage-dropzone","*",_.bind(this.__elementDragEnd,this)),Giphy.Events.on("optionalfields:upload",this.disable,this),Giphy.Events.on("optionalfields:pause",this.enable,this),Giphy.Events.on("optionalfields:complete",this.remove,this),this.render(),this.dropzone}return t.prototype.__drop=function(t){if(t.preventDefault(),t.stopPropagation(),!this.isDisabled)return t.dataTransfer&&t.dataTransfer.getData("URL")&&Giphy.Events.trigger("dropzone:urlDrop",t.dataTransfer.getData("URL")),clearTimeout(this.hoverDelay),this.dropPosition.x=t.pageX,this.dropPosition.y=t.pageY-this.$win.scrollTop(),this.dropDelay=setTimeout(_.bind(this.drop,this),20),!1},t.prototype.__elementDragStart=function(){this.isDisabled||(this.dropzone.disable(),this.disable())},t.prototype.__elementDragEnd=function(){this.isDisabled&&(this.dropzone.enable(),this.enable())},t.prototype.__error=function(t,e,i){clearTimeout(this.dropDelay),this.powerglove?(this.$drop.addClass("nope"),this.errorCallback(t,e,i),this.powerglove.errorAnimation().then(_.bind(function(){return this.$drop.addClass("go-away"),this.powerglove.errorAnimationOut()},this)).done(_.bind(this.stopDrag,this))):(this.stopDrag(),this.errorCallback(t,e,i))},t.prototype._showImagePreview=function(t){t&&(this.$dropImage.css("background-image","url("+t+")"),_.defer(_.bind(this.drop,this)))},t.prototype.render=function(){this.$drop=$(this.template()),this.$dropImage=this.$drop.find(".drop-image"),this.powerglove=new o["default"]({el:this.$drop.find(".powerglove")})},t.prototype.disable=function(){this.isDisabled=!0,this.stopDrag()},t.prototype.enable=function(){this.isDisabled=!1},t.prototype.startDrag=function(){this.isDragging||(this.$body.addClass("drag-n-drop").append(this.$drop),this.isDragging=!0,this.powerglove&&this.powerglove.render())},t.prototype.stopDrag=function(){this.powerglove&&this.powerglove.remove(),this.$body.removeClass("drag-n-drop"),this.$drop.removeClass("drop nope go-away").remove(),this.$dropImage.attr("style",""),this.isDragging=!1,this.isDropping=!1},t.prototype.drop=function(){this.isDragging&&!this.isDropping&&(this.isDropping=!0,this.$drop.one(this.transitionEnd,_.bind(this.stopDrag,this)),this.$drop.addClass("drop"))},t.prototype.remove=function(){this.dropzone.disable(),this.stopDrag()},t}();e["default"]=a},578:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){return i(this,t),e=e||{},this.$win=$(window),this.$el=$(e.el||""),this.$inner=this.$el.find(".glove-inner"),this.$preview=$(e.preview||""),this.pushPoint={x:0,y:0},this.transitionEnd=Giphy.Utils.transitionEnd(),this.resetStyle(),this}return t.prototype.__resize=function(){if(this.$preview.length){var t=this.$preview.offset();this.pushPoint.x=t.left+.5*this.$preview.width(),this.pushPoint.y=t.top+.5*this.$preview.height()-this.$win.scrollTop()}else this.pushPoint.x=.5*this.$win.width(),this.pushPoint.y=.5*this.$win.height()},t.prototype._getPushDistance=function(t,e){t=t||0,e=e||0;var i=this.pushPoint.x-t,s=this.pushPoint.y-e,r=Math.sqrt(Math.pow(i,2)+Math.pow(s,2));return Math.round(r)},t.prototype.render=function(){this.$el.length&&(this.$win.on("resize.full-page-glove",_.bind(this.__resize,this)),this.__resize())},t.prototype.remove=function(){this.$el.length&&(this.resetStyle(),this.$win.off(".full-page-glove"))},t.prototype.resetStyle=function(){this.$el.length&&(this.$el.attr("style",""),this.$inner.attr("style",""))},t.prototype.pointTo=function(t,e){t=t||0,e=e||0;var i=Math.atan2(this.pushPoint.x-t,this.pushPoint.y-e),s=i*(180/Math.PI)*-1+180,r="rotate("+s+"deg)",n=_.extend(Giphy.Utils.prefixStyle("transform",r),{left:t,top:e});this.$el.css(n)},t.prototype.pushTo=function(t,e){var i=this._getPushDistance(t,e),s=Giphy.Utils.prefixStyle("transform","translateY(-"+i+"px)");this.$inner.css(s)},t.prototype.errorAnimation=function(){var t=$.Deferred();return this.resetStyle(),setTimeout(_.bind(function(){t.resolve()},this),1500),t.promise()},t.prototype.errorAnimationOut=function(){var t=$.Deferred(),e=setTimeout(function(){t.resolve()},3e3);return this.$el.one(this.transitionEnd,_.bind(function(){clearTimeout(e),t.resolve()},this)),t.promise()},t}();e["default"]=s},579:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(571),o=s(n),a=i(580),l=s(a),h=i(585),u=s(h),p=function(){function t(e){r(this,t),this.template=_.template('<div class="preview-slide" data-id="<%- id %>" style="background-image:url(<%- url %>)"></div>'),e=e||{},this.$el=$(e.el),this.previewImage=document.createElement("img"),this.previewCanvas=document.createElement("canvas"),this.previewContext=this.previewCanvas.getContext("2d"),this.optionalFields=e.optionalFields,this.gifProxyUrl="//p.giphy.com/fetch?gif=",this.currentSlide=0,this.minDuration=100,this.maxDuration=3e3,this.maxTotalDuration=14.9,this.maxWidth=560,this.maxHeight=322,this.stillImageDuration=this.__duration(.5),this.currentSliderPercent=0,this.isAnimatingIcons=!1,this.sliderDirection=0,this.frameTimeout=null,this.slides={},this.gifDurations={},this.timer=null,this.isTooLong=!1,this.submitUrl=e.submitUrl||"",this.render()}return t.prototype.__toggleList=function(t){t.preventDefault(),this.$slides.removeClass("grid")},t.prototype.__toggleGrid=function(t){t.preventDefault(),this.$slides.addClass("grid")},t.prototype.__addedFile=function(t,e){if(e){if(Giphy.Events.trigger("creationtools:condensemenu"),this._resetPreview(),"url"===e.type)return void this._processUrl(e);var i=new FileReader;i.onloadend=_.bind(function(){var t=new Uint8Array(i.result);this._processGif(e,t)},this),e.type.indexOf("image/gif")>-1?i.readAsArrayBuffer(e):this._loadImg(e)}},t.prototype.__removedFile=function(t,e){this._resetPreview(),e&&this.slides[e.id]&&delete this.slides[e.id],this._updatePreviewSize(),this._checkTotalDuration(),_.size(this.slides)&&_.defer(_.bind(this.updatePreview,this))},t.prototype.__delay=function(t,e){e.percent>this.currentSliderPercent?this.sliderDirection=1:e.percent<this.currentSliderPercent?this.sliderDirection=-1:this.sliderDirection=0,this.currentSliderPercent=e.percent,this.stillImageDuration=this.__duration(e.percent),this._updateSpeedIcons(),this._checkTotalDuration()},t.prototype.__sliderStart=function(){this.isAnimatingIcons=!0,this._updateSpeedIcons()},t.prototype.__sliderStop=function(){this.sliderDirection=0,this.isAnimatingIcons=!1,this.$speedIcons.removeClass("fast-speed slow-speed")},t.prototype.__duration=function(t){return this.minDuration+parseInt(t*(this.maxDuration-this.minDuration))},t.prototype._updateSpeedIcons=function(){this.isAnimatingIcons&&this.$speedIcons.toggleClass("fast-speed",this.sliderDirection===-1).toggleClass("slow-speed",1===this.sliderDirection)},t.prototype._loadImg=function(t){var e={canvas:!0,maxWidth:600};window.loadImage.parseMetaData(t,_.bind(function(i){i.exif&&(e.orientation=i.exif.get("Orientation")),window.loadImage(t,_.bind(function(e){this._processBinary(t,e.getContext("2d").getImageData(0,0,e.width,e.height),e.toDataURL("image/png"))},this),e)},this))},t.prototype._processGif=function(t,e){if(t){var i=e||t.name;if(!e&&i.indexOf("giphy.com")<0){var s=Giphy.Utils.urlRE.exec(i);s&&s.length>1&&(i=this.gifProxyUrl+s[1].replace(/.*?:\/\//g,""))}Giphy.Events.trigger("slideshow:processing",{id:t.id,name:t.name,isComplete:!1});var r=_.bind(function(e){var i=[],s=e.frames.length/(.001*e.duration);if(_.size(e.frames)>1){if(s>16.7){var r=[];_.each(e.frames,function(t){for(var e=0;e<Math.round(.1*t.delay);e++)r.push({delay:60,width:t.width,height:t.height,imageData:t.data})}),_.each(r,function(t,e){e%6===0&&i.push(t)})}else _.each(e.frames,function(t){i.push({delay:t.delay,width:t.width,height:t.height,imageData:t.data})});this.gifDurations[t.id]=e.duration}else{var n=e.frames[0];i.push({width:n.width,height:n.height,imageData:n.data})}Giphy.Events.trigger("slideshow:processing",{id:t.id,name:t.name,isComplete:!0}),this._updateListItemPreview(t.id,e.still),this.slides[t.id]=i,this._processingComplete()},this);e?Giphy.GifParser.loadBinary(i).done(r):Giphy.GifParser.loadUrl(i).fail(_.bind(function(){o["default"].show("SOMETHING_WENT_WRONG"),this.filePortal.files().remove(t)},this)).done(r)}},t.prototype._processBinary=function(t,e,i){t&&(this.slides[t.id]=[{width:e.width,height:e.height,imageData:e}],this._updateListItemPreview(t.id,i||t.name),this._processingComplete())},t.prototype._processUrl=function(t){if(t){var e=t.name.indexOf(".gif")>-1;if(e)return void this._processGif(t);var i=this.gifProxyUrl+t.name.replace(/.*?:\/\//g,"");Giphy.Utils.preloadImage(i).done(_.bind(function(e){this.slides[t.id]={url:e.src,width:e.naturalWidth,height:e.naturalHeight},this._updateListItemPreview(t.id,e.src),this._processingComplete()},this))}},t.prototype._processingComplete=function(){this.updatePreview(),this._updatePreviewSize();var t=_.filter(this.slides,function(t){return t.length>1});this.$delaySlider.toggleClass("hidden",_.size(t)===_.size(this.slides)),this._checkTotalDuration()},t.prototype._updateListItemPreview=function(t,e){var i=this.$slides.find("#"+t+" .upload-preview");i.length&&i.css("background-image","url("+e+")")},t.prototype._updatePreviewSize=function(){var t=0,e=0;if(_.size(this.slides)>0){_.each(this.slides,function(i){_.isArray(i)?_.each(i,function(i){i.width>t&&(t=i.width),i.height>e&&(e=i.height)}):(i.width>t&&(t=i.width),i.height>e&&(e=i.height))});var i=t/e;t=this.maxWidth,e=this.maxWidth/i,e>this.maxHeight&&(e=this.maxHeight,t=this.maxHeight*i),this.previewCanvas.width=t,this.previewCanvas.height=e,this.$el.addClass("ready")}else this.previewCanvas.width=this.maxWidth,this.previewCanvas.height=this.maxHeight,this.$el.removeClass("ready");this.$preview.css({height:e,width:t})},t.prototype._resetPreview=function(){clearTimeout(this.frameTimeout),clearTimeout(this.timer),this.$preview.empty().removeClass("active"),this.previewContext.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.previewImage.src="",this.$delaySlider.toggleClass("hidden",this.filePortal.isOnlyGifs())},t.prototype._preview=function(){var t=$.Deferred(),e=this.filePortal.files();if(e.length()>=1){var i=e.cycle(),s=this.slides[i.id]||{},r=this;if(this.$preview.addClass("active"),this.previewContext.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.previewImage.src="",_.isArray(s)){var n=s.length,o=0,a=document.createElement("canvas"),l=a.getContext("2d"),h=function c(){var e=s[o];clearTimeout(r.frameTimeout);var i=e.width/e.height,h=r.previewCanvas.width,u=h/i,p=0,d=0;u>r.previewCanvas.height&&(u=r.previewCanvas.height,h=u*i),p=.5*(r.previewCanvas.width-h),d=.5*(r.previewCanvas.height-u),a.width=e.width,a.height=e.height,l.clearRect(0,0,r.previewCanvas.width,r.previewCanvas.height),l.putImageData(e.imageData,0,0),r.previewContext.clearRect(0,0,r.previewCanvas.width,r.previewCanvas.height),r.previewContext.drawImage(a,p,d,h,u),o<n-1?(r.frameTimeout=setTimeout(c,s[o].delay||r.stillImageDuration),o++):t.resolve(e.delay||r.stillImageDuration)};this.$preview.html(this.previewCanvas),h()}else if(_.has(s,"url")){var u=s.width/s.height,p=this.$preview.width(),d=this.$preview.height();this.previewImage.src=s.url,this.previewImage.width=p,this.previewImage.height=this.previewImage.width/u,this.previewImage.height>d&&(this.previewImage.height=d,this.previewImage.width=d*u),this.$preview.html(this.previewImage),t.resolve()}else t.resolve(1)}else t.resolve(500);return t.promise()},t.prototype._checkTotalDuration=function(){var t=0,e=_.flatten(_.values(this.slides));if(e.length){_.each(e,_.bind(function(e){t+=e.delay||this.stillImageDuration},this));var i=t/1e3;i>this.maxTotalDuration?this._showDurationError(Math.ceil(i-this.maxTotalDuration)):this._resetDurationError()}},t.prototype._showDurationError=function(t){var e=o["default"].showDurationError("GIF",t+" seconds");this.$uploadButton.addClass("error"),this.$delaySlider.addClass("error"),this.$uploadButton.text(e),this.isTooLong=!0},t.prototype._resetDurationError=function(){this.isTooLong&&(this.$uploadButton.removeClass("error").text(this.$uploadButton.data("label")),this.$delaySlider.removeClass("error"),this.isTooLong=!1,o["default"].showResolved())},t.prototype.__submit=function(){this.filePortal.submit()},t.prototype._cacheSelectors=function(){this.$preview=this.$el.find(".slideshow-images"),this.$slides=this.$el.find("#sortable"),this.$delaySlider=this.$el.find(".slideshow-delay"),this.$duration=this.$el.find("#delay"),this.$speedIcons=this.$el.find(".speed-icons"),this.$slowSpeedIcon=this.$el.find(".speed-icons .speed-icon.slow"),this.$fastSpeedIcon=this.$el.find(".speed-icons .speed-icon.fast"),this.$uploadButton=$("#upload-gif-button")},t.prototype.render=function(){this.$el.length&&(this._cacheSelectors(),this.previewCanvas.width=this.maxWidth,this.previewCanvas.height=this.maxHeight,this.captionControl=new l["default"]($(".caption-control"),$(".slideshow-preview")),this.filePortal=new u["default"]({url:this.submitUrl,sortableList:this.$slides,fileTypes:["image/gif","image/png","image/jpeg"],maxTotalFilesize:100,uploadMultiple:!0,parallelUploads:50,defaultTags:"giphyslideshow",maxFiles:50,minFiles:2,parentView:this}),this.$el.on("sliderupdate.slideshow","#delay",_.throttle(_.bind(this.__delay,this),300)),this.$el.on("sliderstart.slideshow","#delay",_.bind(this.__sliderStart,this)),this.$el.on("sliderstop.slideshow","#delay",_.bind(this.__sliderStop,this)),this.$el.on("click.slideshow","#toggle-list",_.bind(this.__toggleList,this)),this.$el.on("click.slideshow","#toggle-grid",_.bind(this.__toggleGrid,this)),Giphy.Events.on("fileportal:added",this.__addedFile,this),Giphy.Events.on("fileportal:removed",this.__removedFile,this),Giphy.Events.on("optionalfields:upload",this.__submit,this))},t.prototype.updatePreview=function(){clearTimeout(this.frameTimeout),clearTimeout(this.timer),this._preview().done(_.bind(function(t){t=t||this.stillImageDuration,this.timer=setTimeout(_.bind(this.updatePreview,this),t)},this))},t}();e["default"]=p},580:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(581),o=s(n),a=i(582),l=s(a),h=function(){function t(e,i){r(this,t),this.$controls=$(e),this.$previewCanvas=$(i),this.captionStyles=null,this.hasCaption=!1,this.currentCaptionStyle=null,this.render(),this._cacheSelectors()}return t.prototype.__captionKeydown=function(t){if(27===t.which)return t.preventDefault(),this.updateCaption(!0),!1},t.prototype.__captionInput=function(){var t=this.$captionInput.html();t.length>0&&!this.hasCaption?this.updateCaption():!t.length&&this.hasCaption&&this.updateCaption(!0)},t.prototype.__captionRemove=function(t){t.preventDefault(),this.updateCaption(!0)},t.prototype.__captionStyleUpdate=function(t,e){this.currentCaptionStyle=e,this.hasCaption&&this.caption&&this.caption.updateStyle(e)},t.prototype.updateCaption=function(t){t=t||!1,this.hasCaption?this.remove():t||(this.hasCaption=!0,this.$controls.addClass("has-caption"),this.caption=new l["default"]({el:this.$previewCanvas,input:this.$captionInput,style:this.currentCaptionStyle}),this.captionStyles&&this.captionStyles.updateAnimationStyle())},t.prototype.getCaption=function(){if(!this.caption)return"";var t=this.caption.getImage();return t.indexOf("data:image/png;base64,")>-1&&(t=_.last(t.split("data:image/png;base64,"))),t},t.prototype._cacheSelectors=function(){this.$captionInput=this.$controls.find("#caption-input"),this.$captionStyles=this.$controls.find(".caption-styles")},t.prototype.render=function(){this.captionStyles=new o["default"]({el:this.$controls.find(".caption-styles")}),this.$controls.on("keydown.caption-control","#caption-input",_.bind(this.__captionKeydown,this)),this.$controls.on("inputelement:input.caption-control","#caption-input",_.bind(this.__captionInput,this)),this.$controls.on("click.caption-control",".remove-caption",_.bind(this.__captionRemove,this)),Giphy.Events.on("captionpreview:remove",this.__captionRemove,this),Giphy.Events.on("captionstyles:update",this.__captionStyleUpdate,this)},t.prototype.remove=function(){this.$captionInput.html("").trigger("input"),this.$controls.removeClass("has-caption"),this.hasCaption=!1,this.caption&&(this.caption.remove(),delete this.caption)},t}();e["default"]=h},581:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),this.options=e||{},this._configure(),this._cacheSelectors(),this.render()}return t.prototype.__animationClick=function(t){t.preventDefault();var e=$(t.currentTarget),i=e.data();this.$animations.removeClass("active"),e.addClass("active"),Giphy.Events.trigger("captionstyle:updateanimation",i.animation)},t.prototype.__fontClick=function(t){t.preventDefault();var e=$(t.currentTarget),i=e.data();this.$styles.removeClass("active"),e.addClass("active"),this.updateStyle(i.style,i.color)},t.prototype.__colorClick=function(t){t.preventDefault();var e=$(t.currentTarget),i=_.without(e.get(0).className.split(/\s+/),"active","color-style");this.updateStyle(this.currentStyle,_.first(i))},t.prototype._configure=function(){this.$el=$(this.options.el||""),this.currentStyle=(this.options.style||"default").toLowerCase(),this.currentColor=this.options.color||"white"},t.prototype._cacheSelectors=function(){this.$colors=this.$el.find(".color-style"),this.$styles=this.$el.find(".font-style"),this.$animations=this.$el.find(".animation-style")},t.prototype.updateStyle=function(t,e){t=t||this.currentStyle,e=e||this.currentColor,this.currentStyle=t,this.currentColor=e,this.$colors.removeClass("active");var i="";_.each(this.$colors,function(t){var s=$(t);s.hasClass(e)&&(s.addClass("active"),i=s.css("background-color"))}),Giphy.Events.trigger("captionstyles:update",{color:i,style:this.currentStyle,isDark:"black"===this.currentColor})},t.prototype.render=function(){this.$el.length&&(this.$el.on("click.caption-styles",".font-style",_.bind(this.__fontClick,this)),this.$el.on("click.caption-styles",".color-style",_.bind(this.__colorClick,this)),this.$el.on("click.caption-styles",".animation-style",_.bind(this.__animationClick,this)),this.$styles.each(_.bind(function(t,e){var i=$(e),s=i.data("style");s===this.defaultStyle&&i.trigger("click")},this)))},t.prototype.updateAnimationStyle=function(){this.$animations.each(_.bind(function(t,e){var i=$(e);i.hasClass("active")&&i.trigger("click")},this))},t.prototype.remove=function(){this.$el.off(".caption-styles")},t}();e["default"]=s},582:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(583),o=s(n),a=i(584),l=s(a),h=function(){function t(e){r(this,t),this._resizeTextarea=_.throttle(function(){if(this.$textarea.length){var t=0,e=this.$resize.height();if(this.$textarea.css({fontSize:this.maxFontSize,height:""}),t=this.$textarea.get(0).scrollHeight,t>e){for(var i=this.maxFontSize;i>this.minFontSize&&(i--,this.$textarea.css("font-size",i),!(this.$textarea.get(0).scrollHeight<e)););this.fontSize=i,this.$textarea.css("font-size",this.fontSize),t=this.$textarea.get(0).scrollHeight}this.$textarea.css({height:t,top:.5*(e-t)})}},50),this.template=_.template(['<div class="caption-preview-wrapper">','<div class="caption-resize overlay-draggable" style="width:100%">','<div class="input-element caption-text" contenteditable="true" data-multiline="true"></div>','<canvas class="caption-canvas"></canvas>','<div class="dragger"></div>','<div class="remove-button button red"><i class="ss-icon ss-delete"></i></div>',"</div>","</div>"].join("")),this.options=e||{},this.$el=$(this.options.el||""),this._configure(),this.render()}return t.prototype.__mousedown=function(t){var e=$(t.target).hasClass("dragger");this.isEditing&&!e||this._startDrag(t.pageX,t.pageY,e)},t.prototype.__mousemove=function(t){var e;if(this.isResizing){e=this.$resize.offset();var i=t.pageX-e.left,s=t.pageY-e.top;this.resizeText(i+5,s+5)}else{e=this.$el.offset();var r=t.pageX-e.left-this.startOffset.left,n=t.pageY-e.top-this.startOffset.top;this.positionText(r,n)}},t.prototype.__mouseup=function(){this._stopDrag()},t.prototype.__doubleClick=function(){this._stopDrag(),this._startEdit()},t.prototype.__input=function(t){this.refreshText($(t.currentTarget).html())},t.prototype.__inputBlur=function(t){var e=$(t.currentTarget).html();this._stopEdit(),e.trim().length||this.remove(),this._stopEdit()},t.prototype._startDrag=function(t,e,i){t=t||0,e=e||0,i=i||!1;var s=this.$resize.offset();this.startOffset={left:t-s.left,top:e-s.top,width:this.$resize.outerWidth(),height:this.$resize.outerHeight()},this.isDragging=!i,this.isResizing=i,this.$body.on("mousemove.caption-preview",_.bind(this.__mousemove,this)),this.$body.on("mouseup.caption-preview",_.bind(this.__mouseup,this)),this.$wrapper.toggleClass("dragging",this.isDragging).toggleClass("resizing",this.isResizing)},t.prototype._stopDrag=function(){this.$wrapper.removeClass("dragging resizing"),this.$body.off(".caption-preview"),this.isDragging=!1,this.isResizing=!1,this.startOffset={}},t.prototype._startEdit=function(){this.isEditing=!0,this.$wrapper.addClass("editing"),this.$textarea.focus(),Giphy.Utils.selectText(this.$textarea.get(0))},t.prototype._stopEdit=function(){this.isEditing&&(this.isEditing=!1,this.$wrapper.removeClass("editing"))},t.prototype._updateScale=function(){if(this.$el.length){var t=this.$el.data(),e=t.videoWidth||this.$el.width();this.maxFontSize*=t.scale||1,this.minFontSize*=t.scale||1,this.canvasText&&this.canvasText.updateScale(e/this.$el.width())}},t.prototype._configure=function(){this.maxFontSize=40,this.minFontSize=10,this.fontSize=this.maxFontSize,this.canvas=null,this.context=null,this.maxHeight=0,this.maxWidth=0,this.isDragging=!1,this.isResizing=!1,this.isEditing=!1,this.startOffset={},this.scale=1,this.canvasText=null},t.prototype._cacheSelectors=function(){this.$body=$("body"),this.$input=$(this.options.input),this.$wrapper=this.$el.find(".caption-preview-wrapper"),this.$resize=this.$el.find(".caption-resize"),this.$textarea=this.$el.find(".caption-text"),this.$canvas=this.$el.find(".caption-canvas")},t.prototype.render=function(){this.$el.length&&(this.$el.append(this.template()),this._cacheSelectors(),this.maxHeight=this.$el.height(),this.maxWidth=this.$el.width(),this.canvas=this.$canvas.get(0),this.context=this.canvas.getContext("2d"),this.$el.on("mousedown.caption-preview",".caption-resize",_.bind(this.__mousedown,this)),this.$el.on("dblclick.caption-preview",".caption-resize",_.bind(this.__doubleClick,this)),this.$el.on("inputelement:input.caption-preview",".caption-text",_.bind(this.__input,this)),this.$el.on("blur.caption-preview",".caption-text",_.bind(this.__inputBlur,this)),this.$el.on("click.caption-preview",".remove-button",_.bind(this.remove,this)),this.$input.on("inputelement:input.caption-preview",_.bind(this.__input,this)),this.$input.on("blur.caption-preview",_.bind(this.__inputBlur,this)),this.textareaInput=new l["default"]({el:this.$textarea,emojis:!0,multiline:!0}),this.canvasText=new o["default"]({el:this.$canvas,textarea:this.$textarea,scale:1}),this._updateScale(),this.refreshText(),this.positionText(),this.options.style&&this.updateStyle(this.options.style),Giphy.Events.trigger("captionpreview:add",this))},t.prototype.positionText=function(t,e){if(this.$resize.length){var i=this.$resize.offset(),s=this.$resize.outerHeight(),r=this.$resize.outerWidth();t=_.isUndefined(t)?i.left:t,e=_.isUndefined(e)?i.top:e;var n=Math.max(t,0),o=Math.max(e,0);n+r>this.maxWidth&&(n=this.maxWidth-r),o+s>this.maxHeight&&(o=this.maxHeight-s),this.$resize.css({left:n,top:o})}},t.prototype.resizeText=function(t,e){if(this.$resize.length){var i=this.$resize.position();t=Math.min(t||this.$resize.outerWidth(),this.maxWidth),e=Math.min(e||this.$resize.outerHeight(),this.maxHeight),i.left+t>this.maxWidth&&(t=this.maxWidth-i.left),i.top+e>this.maxHeight&&(e=this.maxHeight-i.top),this.$resize.css({height:e,width:t}),this.refreshText()}},t.prototype.refreshText=function(t){this.$input.length&&this.$textarea.length&&(_.isUndefined(t)&&(t=this.$input.html()||this.$textarea.html()),t!==this.$input.html()&&(this.$input.html(t),this.$input.trigger("input")),t!==this.$textarea.html()&&(this.$textarea.html(t),this.$textarea.trigger("input")),this._resizeTextarea(),this.canvasText&&this.canvasText.update())},t.prototype.getImage=function(){if(this.canvasText){var t=this.$el.offset(),e=this.$textarea.offset();return this.canvasText.save({width:this.maxWidth,height:this.maxHeight,left:e.left-t.left,top:e.top-t.top})}},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getResizeElement=function(){return this.$resize},t.prototype.updateStyle=function(t){switch(this.$textarea.attr("data-style",t.style),t.style){case"meme":this.maxFontSize=80;break;case"subtitle":this.maxFontSize=20;break;case"pixel":this.maxFontSize=26;break;default:this.maxFontSize=40}this.canvasText&&this.canvasText.updateStyle(t),this.refreshText()},t.prototype.remove=function(){this.$el.length&&(this.$el.off(".caption-preview"),this.$input.length&&this.$input.off(".caption-preview"),this.$wrapper.length&&this.$wrapper.remove(),this.canvasText&&this.canvasText.remove(),Giphy.Events.trigger("captionpreview:remove",this))},t}();e["default"]=h},583:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),this.options=e||{},this._configure(),this.render()}return t.prototype._drawEmoji=function(t,e){var i=$.Deferred();if(e=e||{},t){t=t.toLowerCase();var s=String(t.match(/.*\/(.*)$/)[1]).split("?")[0],r=new Image,n=_.bind(function(){this.context.save(),this.context.shadowColor="rgba(0, 0, 0, 0.5)",this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowBlur=e.shadow,"default"===this.currentStyle||"pixel"===this.currentStyle?(this.context.shadowOffsetX=e.shadow,this.context.shadowOffsetY=e.shadow,this.context.shadowBlur=0):"subtitle"!==this.currentStyle||this.isDark||(this.context.shadowBlur=2*e.shadow),this.context.drawImage(r,e.left,e.top-.5*this.emojiSize,this.emojiSize,this.emojiSize),this.context.restore()},this);_.has(this.loadedEmojis,s)?(r=this.loadedEmojis[s],n(),i.resolve()):(r.onload=_.bind(function(){this.loadedEmojis[s]=r,n(),i.resolve()},this),r.onerror=function(){i.reject()},r.src=this.emojiPath+s)}else i.reject();return i.promise()},t.prototype._drawText=function(t,e){var i=$.Deferred();return e=e||{},t?(this.context.save(),"default"===this.currentStyle||"pixel"===this.currentStyle?(this.context.fillStyle="rgba(0, 0, 0, 0.5)",this.context.strokeStyle="rgba(0, 0, 0, 0.5)",this.context.lineWidth=e.stroke,this.context.lineJoin="round",this.context.fillText(t,e.left+e.shadow,e.top+e.shadow),this.context.strokeText(t,e.left+e.shadow,e.top+e.shadow)):"subtitle"!==this.currentStyle||this.isDark||(this.context.shadowColor="rgba(0, 0, 0, 0.5)",this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowBlur=2*e.shadow),this.context.fillStyle=this.fontColor,this.context.strokeStyle=this.isDark?"#C9C9C9":"#333",this.context.lineWidth=e.shadow,this.context.lineJoin="round",this.context.strokeText(t,e.left,e.top),this.context.fillText(t,e.left,e.top),this.context.restore(),i.resolve()):i.reject(),i.promise()},t.prototype._drawLine=function(t,e){t=t||"",e=e||0," "===t.charAt(0)&&(t=t.substr(1));var i=.5*this.canvas.width,s=i-.5*this.context.measureText(t.replace(this.emojiRegex,"")).width,r=_.compact(t.split(this.emojiRegex)),n=this.fontSize/10,o=n/2;t.match(this.emojiRegex)&&(s-=t.match(this.emojiRegex).length*this.emojiSize*.5),$.when.apply(this,_.map(r,function(t){var i=t.match(Giphy.Utils.urlRE),r={shadow:n,stroke:o,left:s,top:e};return s+=i?this.emojiSize:this.context.measureText(t).width,i?this._drawEmoji(t,r):this._drawText(t,r)},this))},t.prototype._updateText=function(){if(this.$textarea.length){var t=this._filterText(this.$textarea.html()),e=parseInt(this.$textarea.css("line-height"),10)*this.scale,i=[],s="",r=Math.round(.5*e),n=0;this.fontSize=parseInt(this.$textarea.css("font-size"),10)*this.scale,this.emojiSize=.8*this.fontSize,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width=this.$textarea.width()*this.scale,this.canvas.height=this.$textarea.height()*this.scale,this.context.textBaseline="middle",this.context.font=this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px "+this.font+", sans-serif","uppercase"===this.$textarea.css("text-transform")&&(t=t.toUpperCase()),_.each(t.split("\n"),function(t){i=i.concat(t.split(" ")),i.push("\n")});for(var o=0;o<i.length;o++){var a=(o>0?" ":"")+i[o],l=a.match(this.emojiRegex),h=this.context.measureText(a.replace(this.emojiRegex,"")).width,u="\n"===i[o];l&&(h+=this.emojiSize*l.length),(u||n+h>this.canvas.width)&&(this._drawLine(s,r),r+=e,n=0,s=""),u||(s+=a,n+=h,o===i.length-1&&this._drawLine(s,r))}}},t.prototype._filterText=function(t){var e=$("<div></div>").html(t),i="";return e.find(".emojione").each(function(){var t=$(this);t.replaceWith(":::"+t.attr("src")+":::")}),e.find("div, p").each(function(){var t=$(this);t.text().trim().length||t.replaceWith("<br>")}),i=e.html(),"<"===i.charAt(0)&&(i=i.replace(/<(?!i\s*\/?)[^>]+>/,"")),i=i.replace(/<div>/g,"\n<div>"),i=i.replace(/<p>/g,"\n<p>"),i=i.replace(/<br\s*\/?>/g,"\n"),i=i.replace(/<(?!i\s*\/?)[^>]+>/g,""),i=i.replace(/&nbsp;/g," ")},t.prototype._configure=function(){this.$el=$(this.options.el||""),this.$textarea=$(this.options.textarea||""),this.emojiPath="/static/img/emoji_one/",this.scale=this.options.scale||1,this.fontSize=0,this.font="NexaBlack",this.fontColor="#fff",this.fontStyle="normal",this.fontWeight="normal",
this.currentStyle="default",this.emojiSize=0,this.loadedEmojis=[],this.isDark=!1,this.emojiRegex=/\:::(.*?)\:::/g},t.prototype.render=function(){this.$el.length&&(this.canvas=this.$el.get(0),this.context=this.canvas.getContext("2d"),this.update())},t.prototype.update=function(){if(this.$textarea.length){var t=this.$textarea.position();this._updateText(),this.$el.css({height:this.$textarea.height(),left:t.left,top:t.top,width:this.$textarea.width()})}},t.prototype.updateScale=function(t){this.scale=t||this.scale},t.prototype.updateStyle=function(t){switch(this.fontColor=t.color,this.currentStyle=t.style,this.isDark=t.isDark||!1,t.style){case"meme":this.font="Impact",this.fontStyle="normal",this.fontWeight="bold";break;case"subtitle":this.font="Arial",this.fontStyle="italic",this.fontWeight="bold";break;case"pixel":this.font="Emulogic",this.fontStyle="normal",this.fontWeight="normal";break;case"default":this.font="NexaBlack",this.fontStyle="normal",this.fontWeight="normal";break;default:this.font=t.style||"NexaBlack",this.fontStyle="normal",this.fontWeight="normal"}this._updateText()},t.prototype.save=function(t){t=t||{};var e=t.width||0,i=t.height||0,s=t.left||0,r=t.top||0,n=document.createElement("canvas"),o=n.getContext("2d"),a=s*this.scale,l=r*this.scale;return n.width=e*this.scale,n.height=i*this.scale,o.imageSmoothingEnabled=!1,o.drawImage(this.canvas,a,l,this.canvas.width,this.canvas.height),n.toDataURL()},t.prototype.remove=function(){},t}();e["default"]=s},584:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),this.$el=$(e.el),this.emojis=e.emojis||!1,this.multiline=e.multiline||!1,this.currentHtml="",this.isPaste=!1,window.emojione&&(window.emojione.unicodeAlt=!1),this.$el.attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),this.$el.html().length||this.$el.addClass("empty"),document.execCommand("insertBrOnReturn",!1,"false"),this.render()}return t.prototype.__keydown=function(t){if(!this.multiline&&13===t.which)return t.preventDefault(),t.stopPropagation(),!1},t.prototype.__blur=function(){var t=this.$el.html();t=t.replace(/<(?!img\s*\/?)[^>]+>/g,""),t.length||(this.$el.html("").addClass("empty"),this.currentHtml="",this.$el.trigger("inputelement:input"))},t.prototype.__paste=function(t){t.preventDefault(),t.stopPropagation(),t=t.originalEvent||t;var e=t.clipboardData.getData("text/plain");return e.length&&(e=e.replace(/<(?!i\s*\/?)[^>]+>/g,""),this._pasteAtCaret(e),this.$el.trigger("input")),!1},t.prototype.__input=function(){var t=this.$el.html();if(this.$el.toggleClass("empty",!t.length),t!==this.currentHtml){if(this.emojis){var e=$("<div></div>").html(t);e.find(".emojione").each(function(){$(this).attr("data-rendered",!0)});var i=window.emojione.toImage(e.html());if(e.html(i),e.find(".emojione:not([data-rendered])").length){this.$el.html(i);var s=this.$el.find(".emojione:not([data-rendered])").last();this._setCaretToElement(s.get(0))}}this.currentHtml=this.$el.html(),this.$el.trigger("inputelement:input")}},t.prototype._setCaretToElement=function(t){var e=document.createRange();e.setStartAfter(t),e.setEndAfter(t);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)},t.prototype._pasteAtCaret=function(t,e){if(window.getSelection){var i,s;if(e=e||0,i=window.getSelection(),i.getRangeAt&&i.rangeCount){if(s=i.getRangeAt(0),e){var r=s.cloneRange();r.setStart(s.startContainer,s.startOffset-e),r.setEnd(s.startContainer,s.startOffset),r.deleteContents()}s.deleteContents();var n=document.createElement("div");n.innerHTML=t;for(var o,a,l=document.createDocumentFragment();o=n.firstChild;)a=l.appendChild(o);s.insertNode(l),a&&(s=s.cloneRange(),s.setStartAfter(a),s.collapse(!0),i.removeAllRanges(),i.addRange(s))}}},t.prototype.render=function(){this.$el.on("keydown",_.bind(this.__keydown,this)),this.$el.on("pase",_.bind(this.__paste,this)),this.$el.on("input",_.bind(this.__input,this)),this.$el.on("blur",_.bind(this.__blur,this)),this.$el.on("keyup",_.bind(this.__input,this))},t}();e["default"]=s},585:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0,e["default"]=void 0;var a=i(574),l=s(a),h=i(571),u=s(h),p=function(t){function e(){return r(this,e),n(this,t.apply(this,arguments))}return o(e,t),e.prototype.__addFile=function(t){t=t||{};var e=_.bind(this._addToFiles,this,t,!1);this.dropzoneAddDelay=setTimeout(e,50)},e.prototype._getRequestParams=function(){var t="giphyslideshow";_.isEmpty($("#tags").val())||(t+=","+$("#tags").val());var e=[];return _.each(this.files().files,_.bind(function(t,i){e.push({name:t.name,duration:_.has(this.parentView.gifDurations,t.id)?this.parentView.gifDurations[t.id]:this.parentView.stillImageDuration,index:i,type:t.type})},this)),{session_key:$.cookie("giphy_session_id")||"",api_key:Giphy.CreationApiHelper.apiKey,tags:t,source_post_url:$("#source-post-url").val(),username:$("#username").val(),hidden:$("#is-hidden").val(),slides_data:JSON.stringify(e),watermark:this.parentView.captionControl.getCaption(),rating:this.gifRating,channel_id:this.channelID}},e.prototype.__progress=function(t,e){var i=40;Giphy.Events.trigger("fileportal:progress",{currentFile:1,currentFileName:null,progress:e,totalFiles:1,totalProgress:e,estimatedTime:i})},e.prototype.__complete=function(){},e.prototype.__success=function(t,e){if(_.isUndefined(e)||_.isNull(e))return void u["default"].show("SOMETHING_WENT_WRONG");_.isString(e)&&(e=$.parseJSON(e));var i=e.data;return _.isEmpty(i)||_.isEmpty(i.job_id)?void u["default"].show("SOMETHING_WENT_WRONG"):void Giphy.CreationApiHelper.pollCreateStatus(i.job_id,2e3,null,_.bind(function(t){this._allDone(t.data.result.id)},this))},e.prototype._allDone=function(t){Giphy.Events.trigger("fileportal:complete",{firstFile:{giphy_url:"/gifs/"+t},totalFiles:1})},e.prototype.submit=function(){var t=this.subviews.dropzone,e=this._getRequestParams();t&&t.getQueuedFiles().length>0?(t.options.params=e,t.processQueue()):(Giphy.CreationApiHelper.postCreateSlideshow(e,_.bind(function(t){this.__success(null,t)},this),_.bind(function(){this.serverError("SOMETHING_WENT_WRONG","Oops! Something went wrong")},this)),this.parentView.optionalFields.progressBar.updateWithText("Creating your GIF Slideshow",80,30,_.bind(function(){this.parentView.optionalFields.progressBar.updateWithText("Creating your GIF Slideshow",99,40)},this)))},e}(l["default"]);e["default"]=p},586:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(571),o=s(n),a=i(587),l=s(a),h=i(588),u=s(h),p=i(580),d=s(p),c=i(589),f=s(c),v=i(590),g=s(v),m=i(595),y=s(m),w=function(){function t(e){r(this,t),e=e||{},this.$el=$(e.el),this.subviews={},this.maxDuration=10,this.originalDuration=3,this.duration=this.originalDuration,this.startTime=0,this.videoDuration=0,this.maxVideoSize=536870912,this.maxVideoLength=900,this.filePortal=null,this.defaultTags=e.defaultTags?[e.defaultTags]:[],this.optionalFields=e.optionalFields,this.render()}return t.prototype.makeYouTubeUrlWithId=function(t){return"http://www.youtube.com/watch?v="+t},t.prototype.makeVimeoUrlWithId=function(t){return"http://vimeo.com/"+t},t.prototype.__addedFile=function(t,e){if(this.isVine=!1,"url"===e.type&&e.name.indexOf("youtubeId=")>-1){var i=_.last(e.name.split("youtubeId="));this.$el.addClass("loading-video"),Giphy.CreationApiHelper.getVideoInfo("http://www.youtube.com/watch?v="+i,_.bind(function(t){if(t.uploader&&"mlb"===t.uploader.toLowerCase())o["default"].show("VIDEO_BLOCKED"),Giphy.Events.trigger("creationtools:expandmenu");else{var e=0,s=0;if(t.width&&t.height){var r=t.width/t.height;e=this.$videoPreview.height(),s=e*r,s<this.minWidth&&(s=this.minWidth,e=s/r),s>this.$videoPreview.width()&&(s=this.$videoPreview.width(),e=s/r)}this.renderPreview({type:"youtube",id:i,height:e,width:s})}},this),_.bind(function(){o["default"].show("SOMETHING_WENT_WRONG"),this.$el.removeClass("loading-video")},this)),this.optionalFields.$sourcePostUrl.val(this.makeYouTubeUrlWithId(i))}else if("url"===e.type&&e.name.indexOf("vimeoId=")>-1){var s=_.last(e.name.split("vimeoId="));this.renderPreview({type:"vimeo",id:s}),this.optionalFields.$sourcePostUrl.val(this.makeVimeoUrlWithId(s))}else{var r=Giphy.Utils.isGifmakerUrl(e.name);"url"===e.type&&r?(this.isVine="vine"===r,Giphy.CreationApiHelper.getVideoInfo(e.name,_.bind(function(t){t.url&&this.renderPreview({type:"video",src:t.url,extension:Giphy.Utils.getExtension(t.url)})},this),_.bind(function(t){var e="SOMETHING_WENT_WRONG";t&&t.message&&"unsupported url"===t.message.toLowerCase()&&(e="UNSUPPORTED_URL"),o["default"].show(e)},this)),this.optionalFields.$sourcePostUrl.val(e.name)):this.renderPreview({type:"video",src:"url"===e.type?e.name:window.URL.createObjectURL(e),extension:Giphy.Utils.getExtension(e.name)})}},t.prototype.__previewTimeUpdate=function(t,e){var i=e/this.duration*100;this.$durationSlider.trigger("sliderplayhead",i)},t.prototype.__previewInitialized=function(){this.$el.removeClass("loading-video"),this.$videoPreview.removeClass("loading")},t.prototype.__previewReady=function(t,e){if(e>this.maxVideoLength){var i=Giphy.Utils.formatTimeObject(this.maxVideoLength),s="";i.h&&(s+=i.h+" hours"),i.m&&(s.length&&(s+=", "),s+=i.m+" minutes"),i.s&&(s.length&&(s+=", "),s+=i.s+" seconds");var r="Video must be "+s+" or less.";return o["default"].show("VIDEO_TOO_LONG",r),void Giphy.Events.trigger("uploadbutton:error",r)}Giphy.Events.trigger("uploadbutton:reset"),this.$el.removeClass("loading-video"),this.$videoPreview.removeClass("loading"),this.$controls.removeClass("waiting"),this.videoDuration=e,this.subviews.startTime&&(this.subviews.startTime.remove(),this.subviews.startTime=null),this.subviews.duration&&(this.subviews.duration.remove(),this.subviews.duration=null),this.subviews.startTime=new u["default"]({el:this.$startTime,maxTime:this.videoDuration});var n=this.$durationSlider.data(),a=n.minValue||1,l=n.maxValue||10;this.subviews.duration=new u["default"](_.extend({},this.$duration.data(),{el:this.$duration,minTime:a,maxTime:Math.min(this.videoDuration,l)})),this.isVine&&_.defer(_.bind(function(){this.$durationSlider.trigger("update",{value:l})},this))},t.prototype.__startTimeChange=function(t,e){e=e||0,this.startTime=e,this.subviews.preview&&this.subviews.preview.updateTime(this.startTime,this.duration)},t.prototype.__durationChange=function(t,e){e=e||0,this.duration=e,this.$startTimeSlider.trigger("sliderduration",this.duration),this.subviews.preview&&this.subviews.preview.updateTime(this.startTime,this.duration,!0)},t.prototype._reset=function(){this.startTime=0,this.duration=this.originalDuration,this.subviews.preview&&(this.subviews.preview.remove(),this.subviews.preview=null),this.$videoPreview.css({height:"",width:""})},t.prototype._cacheSelectors=function(){this.$videoPreview=this.$el.find(".video-placeholder"),this.$controls=this.$el.find(".video-controls"),this.$startTime=this.$el.find(".start-time-controls"),this.$duration=this.$el.find(".duration-controls"),this.$uploadButton=this.$el.find("#upload-gif-button"),this.$startTimeSlider=this.$el.find(".start-time-slider"),this.$durationSlider=this.$el.find(".duration-slider")},t.prototype.__submit=function(){this.filePortal.submit()},t.prototype.render=function(){if(this.$el.length){this._cacheSelectors(),this.captionControl=new d["default"]($(".caption-control"),$(".video-placeholder")),this.filePortal=new l["default"]({url:Giphy.CreationApiHelper.apiBaseUrl+"/create/video",fileTypes:[".mp4",".mov","youtube","gifmakerwhitelist","vimeo"],replaceFile:!0,maxFiles:1,maxVideoLength:this.maxVideoLength,maxTotalFilesize:100,defaultTags:this.defaultTags.concat(["giphygifmaker"]).join(","),parentView:this}),this.$el.on("timeupdate.gif-maker",".start-time-controls",_.throttle(_.bind(this.__startTimeChange,this),100)),this.$el.on("timeupdate.gif-maker",".duration-controls",_.throttle(_.bind(this.__durationChange,this),300)),Giphy.Events.on("preview:ready",this.__previewReady,this),Giphy.Events.on("preview:initialized",this.__previewInitialized,this),Giphy.Events.on("fileportal:added",this.__addedFile,this),Giphy.Events.on("optionalfields:upload",this.__submit,this),Giphy.Events.on("preview:currentTimeUpdate",this.__previewTimeUpdate,this);var t=this.$el.data("starting-video-url");if(void 0!==t){var e=this.filePortal._validateUrl(t);this.filePortal._checkFile(e,!0),this.filePortal.subviews.dropzone.disable()}}},t.prototype.renderPreview=function(t){t=t||{},this.$videoPreview.length&&(this._reset(),t.height&&this.$videoPreview.height(t.height+"px"),t.width&&this.$videoPreview.width(t.width+"px"),"youtube"===t.type?this.subviews.preview=new f["default"]({el:this.$videoPreview,id:t.id,startTime:this.startTime,endTime:this.endTime}):"vimeo"===t.type?this.subviews.preview=new g["default"]({el:this.$videoPreview,id:t.id,startTime:this.startTime,endTime:this.endTime}):this.subviews.preview=new y["default"]({el:this.$videoPreview,src:t.src,extension:t.extension,startTime:this.startTime,endTime:this.endTime}),this.$videoPreview.removeClass("waiting").addClass("loading").focus())},t.prototype.remove=function(){this.$el.length&&(this.$el.off(".gif-maker"),Giphy.Events.off("preview:ready"),_.each(this.subviews,function(t){t.remove(),t=null}),this.$videoPreview.length&&this.$videoPreview.addClass("waiting"))},t}();e["default"]=w},587:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0,e["default"]=void 0;var a=i(574),l=s(a),h=i(571),u=s(h),p=function(t){function e(){return r(this,e),n(this,t.apply(this,arguments))}return o(e,t),e.prototype._getRequestParams=function(){var t=this.defaultTags;_.isEmpty($("#tags").val())||(t+=","+$("#tags").val());var e={session_key:$.cookie("giphy_session_id")||"",api_key:Giphy.CreationApiHelper.apiKey,tags:t,source_post_url:$("#source-post-url").val(),username:$("#username").val(),hidden:$("#is-hidden").val(),duration:this.parentView.duration,start:this.parentView.startTime,watermark:this.parentView.captionControl.getCaption(),rating:this.gifRating,channel_id:this.channelID},i=this.files().files[0];if("url"===i.type){var s;if(i.name.indexOf("youtubeId=")>-1){var r=_.last(i.name.split("youtubeId="));s=this.parentView.makeYouTubeUrlWithId(r)}else if(i.name.indexOf("vimeoId=")>-1){var n=_.last(i.name.split("vimeoId="));s=this.parentView.makeVimeoUrlWithId(n)}else s=i.name;e.url=s}return e},e.prototype.__progress=function(t,e){var i=40;Giphy.Events.trigger("fileportal:progress",{currentFile:1,currentFileName:null,progress:e,totalFiles:1,totalProgress:e,estimatedTime:i})},e.prototype.__complete=function(){},e.prototype.__success=function(t,e){if(_.isUndefined(e)||_.isNull(e))return void u["default"].show("SOMETHING_WENT_WRONG");_.isString(e)&&(e=$.parseJSON(e));var i=e.data;return _.isEmpty(i)||_.isEmpty(i.job_id)?void u["default"].show("SOMETHING_WENT_WRONG"):void Giphy.CreationApiHelper.pollCreateStatus(i.job_id,2e3,null,_.bind(function(t){t&&_.has(t,"data")&&_.has(t.data,"result")?this._allDone(t.data.result.id):u["default"].show("SOMETHING_WENT_WRONG")},this))},e.prototype._allDone=function(t){var e="";Giphy.CreationTools&&Giphy.CreationTools.branded&&(e="/minimal"),Giphy.Events.trigger("fileportal:complete",{firstFile:{giphy_url:"/gifs/"+t+e},totalFiles:1})},e.prototype.submit=function(){var t=this.subviews.dropzone,e=this._getRequestParams();t&&t.getQueuedFiles().length>0?(t.options.params=e,t.processQueue()):(Giphy.CreationApiHelper.postCreateVideo(e,_.bind(function(t){this.__success(null,t)},this),_.bind(function(){this.serverError("SOMETHING_WENT_WRONG","Oops! Something went wrong")},this)),this.parentView.optionalFields.progressBar.updateWithText("Creating your GIF",80,30,_.bind(function(){this.parentView.optionalFields.progressBar.updateWithText("Creating your GIF",99,40)},this)))},e}(l["default"]);e["default"]=p},588:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),e=e||{},this.$el=$(e.el),this.timestampDelay=null,this.numberKeydownFlag=!1,this.minTime=e.minTime||0,this.maxTime=e.maxTime||1,this.render()}return t.prototype.__sliderUpdate=function(t,e){this._updateTime(e.value)},t.prototype.__numberInput=function(t){var e=$(t.currentTarget).val();clearTimeout(this.numberInputDelay),this.numberInputDelay=setTimeout(_.bind(function(){this.$slider.trigger("slidervalue",e)},this),this.numberKeydownFlag?1e3:0),this.numberKeydownFlag=!1},t.prototype.__numberKeydown=function(t){return this.numberKeydownFlag=!0,13===t.which?(t.preventDefault(),t.stopPropagation(),clearTimeout(this.numberInputDelay),this.$slider.trigger("slidervalue",$(t.currentTarget).val()),this.numberKeydownFlag=!1,!1):void(38!==t.which&&40!==t.which||(this.numberKeydownFlag=!1))},t.prototype.__timestampKeydown=function(t){if(38===t.which||40===t.which){t.preventDefault(),t.stopPropagation();var e=t.shiftKey?10:1;return e*=40===t.which?-1:1,this.$slider.trigger("sliderincrement",e),!1}},t.prototype.__timestampInput=function(t){var e=$(t.currentTarget),i=e.html();return clearTimeout(this.timestampDelay),isNaN(i.replace(/:\s*/g,""))?(t.preventDefault(),void e.html(Giphy.Utils.formatTime(this.currentTime))):void(this.timestampDelay=setTimeout(_.bind(function(){var t=Math.min(this._parseTime(i),this.maxTime);this.$slider.trigger("slidervalue",t),this.$timestamp.blur()},this),1e3))},t.prototype.__timestampFocus=function(t){var e=document.createRange(),i=window.getSelection();e.selectNodeContents(t.currentTarget),i.removeAllRanges(),i.addRange(e)},t.prototype._parseTime=function(t){if(!t)return 0;var e=0,i=_.map(t.split(":"),function(t){return isNaN(t)?0:parseInt(t,10)});switch(i=_.last(i,3),i.length){case 3:e=60*i[0]*60+60*i[1]+i[2];break;case 2:e=60*i[0]+i[1];break;case 1:e=i[0]}return e},t.prototype._updateTime=function(t,e){this.currentTime!==t&&(this.currentTime=t,this.$timestamp.length&&this.$timestamp.text(Giphy.Utils.formatTime(this.currentTime)),this.$numberInput.length&&this.$numberInput.val(Number(this.currentTime.toFixed(2))),e||this.$el.trigger("timeupdate",this.currentTime))},t.prototype._cacheSelectors=function(){this.$slider=this.$el.find('*[data-ui*="slider"]'),this.$input=this.$el.find(".time-input"),this.$startTime=this.$el.find(".start-time-label"),this.$endTime=this.$el.find(".end-time-label"),this.$timestamp=this.$el.find(".timestamp-input"),this.$numberInput=this.$el.find(".number-input")},t.prototype.render=function(){this.$el.length&&(this._cacheSelectors(),this.$el.on("keydown.time-slider",".timestamp-input",_.bind(this.__timestampKeydown,this)),this.$el.on("input.time-slider",".timestamp-input",_.bind(this.__timestampInput,this)),this.$el.on("click.time-slider",".timestamp-input",_.bind(this.__timestampFocus,this)),this.$el.on("input.time-slider",".number-input",_.bind(this.__numberInput,this)),this.$el.on("keydown.time-slider",".number-input",_.bind(this.__numberKeydown,this)),this.$slider.on("sliderupdate.time-slider",_.throttle(_.bind(this.__sliderUpdate,this),100)),this.$slider.trigger("update",{min:this.minTime,max:this.maxTime}))},t.prototype.remove=function(){this.$el.length&&(this.$slider.trigger("reset"),this.$el.off(".time-slider"),this.$slider.off(".time-slider"))},t}();e["default"]=s},589:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){i(this,t),this.template=_.template('<div id="youtube-preview"></div>'),e=e||{},this.$el=$(e.el||""),this.videoId=e.id,this.minWidth=e.minWidth||480,this.player=null,this.duration=0,this.startTime=e.startTime||0,this.endTime=e.endTime||10,this.timer=null,this.currentTime=this.startTime,this.seekTimeout=null,this.isSeeking=!1,window.YT?this.render():this._loadYoutubeApi(_.bind(function(){this.render()},this))}return t.prototype.__playerReady=function(){this.player.setVolume(0),this.duration=this.player.getDuration(),Giphy.Events.trigger("preview:ready",this.duration)},t.prototype.__playerStateChange=function(t){if(!this.isSeeking)switch(clearInterval(this.timer),t.data){case 1:this.timer=setInterval(_.bind(this._checkVideoStatus,this),100);break;case 0:case 2:this.player.seekTo(this.startTime,!0),this.player.playVideo()}},t.prototype._loadYoutubeApi=function(t){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i),window.onYouTubeIframeAPIReady=t},t.prototype._checkVideoStatus=function(){this.player&&!this.isSeeking&&(this.currentTime+=.1,this.currentTime>=this.endTime&&(this.currentTime=this.startTime,this.player.seekTo(this.startTime)),Giphy.Events.trigger("preview:currentTimeUpdate",this.currentTime))},t.prototype.render=function(){window.YT&&this.$el.length&&(window.onYouTubeIframeAPIReady=null,this.$el.html(this.template()),this.player=new window.YT.Player("youtube-preview",{width:this.$el.width(),height:this.$el.height(),videoId:this.videoId,playerVars:{autoplay:"1",controls:"0",iv_load_policy:"3",rel:"0",fs:"0",showinfo:"0",start:this.startTime},events:{onReady:_.bind(this.__playerReady,this),onStateChange:_.bind(this.__playerStateChange,this)}}))},t.prototype.remove=function(){this.$el.length&&(this.duration=0,this.timer&&(clearInterval(this.timer),this.timer=null),this.player&&(this.player.stopVideo(),this.player=null),this.$el.html("").css({height:"",width:""}))},t.prototype.updateTime=function(t,e,i){this.player&&(e=e||1,t=Math.min(t||0,this.duration-e-1),this.isSeeking=!0,this.startTime=t,this.endTime=t+e,clearTimeout(this.seekTimeout),this.player.pauseVideo(),this.currentTime=i?this.endTime-.001:this.startTime,this.player.seekTo(this.currentTime,!0),this.seekTimeout=setTimeout(_.bind(function(){this.isSeeking=!1,this.player.playVideo()},this),1e3))},t}();e["default"]=s},590:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e,i,s,r){var n={};return Object.keys(s).forEach(function(t){n[t]=s[t]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce(function(i,s){return s(t,e,i)||i},n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(t,e,n),n=null),n}e.__esModule=!0,e["default"]=void 0;var o,a=i(339),l=i(591),h=s(l),u=(o=function(){function t(e){r(this,t),e=e||{},this.$el=$(e.el||""),this.videoId=e.id,this.player=null,this.apiCheck=null,this.minWidth=e.minWidth||480,this.duration=0,this.startTime=e.startTime||0,this.endTime=e.endTime||10,this.timer=null,this.currentTime=this.startTime,this.seekTimeout=null,this.isSeeking=!1,this.render()}return t.prototype._playVideo=function(){this.isSeeking||(clearInterval(this.timer),this.timer=setInterval(this._checkVideoStatus,100))},t.prototype._pauseVideo=function(){var t=this;this.isSeeking||(clearInterval(this.timer),this.player.play().then(function(){t.player.setCurrentTime(t.startTime)}))},t.prototype._checkVideoStatus=function(){var t=this;this.player&&!this.isSeeking&&(this.currentTime+=.1,this.player.getPaused().then(function(e){e?t.player.play().then(t._updateVideoTime):t._updateVideoTime()}))},t.prototype._updateVideoTime=function(){this.isSeeking||(this.currentTime>=this.endTime&&(this.currentTime=this.startTime,this.player.setCurrentTime(this.startTime)),Giphy.Events.trigger("preview:currentTimeUpdate",this.currentTime))},t.prototype.render=function(){this.$el.length&&this.videoId&&(this.$el.html('<div id="vimeo-preview"></div>'),this.player=new h["default"]("vimeo-preview",{id:this.videoId,height:this.$el.height(),width:this.$el.width(),autoplay:!1}),Giphy.Events.trigger("preview:initialized"),this.playerReady())},t.prototype.playerReady=function(){var t=this;this.player.setVolume(0),this.player.on("play",this._playVideo),this.player.on("pause",this._pauseVideo),this.player.on("ended",this._pauseVideo),this.player.getDuration().then(function(e){t.duration=e,t.player.play(),t._playVideo(),Giphy.Events.trigger("preview:ready",t.duration)})},t.prototype.remove=function(){clearTimeout(this.seekTimeout),clearInterval(this.timer),this.player.off("play"),this.player.off("pause"),this.player.off("ended")},t.prototype.updateTime=function(t,e,i){var s=this;this.player&&(e=e||1,t=Math.min(t||0,this.duration-e-1),this.isSeeking=!0,this.startTime=t,this.endTime=t+e,clearTimeout(this.seekTimeout),this.player.pause().then(function(){return s.currentTime=i?s.endTime-.001:s.startTime,Promise.resolve()}).then(this.player.setCurrentTime(this.currentTime)).then(function(){s.seekTimeout=setTimeout(function(){s.isSeeking=!1,s.player.play()},1e3)}))},t}(),n(o.prototype,"_playVideo",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"_playVideo"),o.prototype),n(o.prototype,"_pauseVideo",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"_pauseVideo"),o.prototype),n(o.prototype,"_checkVideoStatus",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"_checkVideoStatus"),o.prototype),n(o.prototype,"_updateVideoTime",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"_updateVideoTime"),o.prototype),n(o.prototype,"updateTime",[a.autobind],Object.getOwnPropertyDescriptor(o.prototype,"updateTime"),o.prototype),o);e["default"]=u},591:function(t,e,i){var s;(function(r,n){!function(e,i){t.exports=i()}(this,function(){"use strict";function o(t,e){return e={exports:{}},t(e,e.exports),e.exports}function a(t,e,i){var s=k.get(t.element)||{};e in s||(s[e]=[]),s[e].push(i),k.set(t.element,s)}function l(t,e){var i=k.get(t.element)||{};return i[e]||[]}function h(t,e,i){var s=k.get(t.element)||{};if(!s[e])return!0;if(!i)return s[e]=[],k.set(t.element,s),!0;var r=s[e].indexOf(i);return r!==-1&&s[e].splice(r,1),k.set(t.element,s),s[e]&&0===s[e].length}function u(t,e){var i=k.get(t);k.set(e,i),k["delete"](t)}function p(t,e){return 0===t.indexOf(e.toLowerCase())?t:""+e.toLowerCase()+t.substr(0,1).toUpperCase()+t.substr(1)}function d(t){return t instanceof window.HTMLElement}function c(t){return!isNaN(parseFloat(t))&&isFinite(t)&&Math.floor(t)==t}function f(t){return/^(https?:)?\/\/(player.)?vimeo.com(?=$|\/)/.test(t)}function v(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.id,i=t.url,s=e||i;if(!s)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(c(s))return"https://vimeo.com/"+s;if(f(s))return s.replace("http:","https:");if(e)throw new TypeError("“"+e+"” is not a valid video id.");throw new TypeError("“"+s+"” is not a vimeo.com url.")}function g(t){for(var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=O,s=Array.isArray(i),r=0,i=s?i:i[Symbol.iterator]();;){var n;if(s){if(r>=i.length)break;n=i[r++]}else{if(r=i.next(),r.done)break;n=r.value}var o=n,a=t.getAttribute("data-vimeo-"+o);(a||""===a)&&(e[o]=""===a?1:a)}return e}function m(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new Promise(function(i,s){if(!f(t))throw new TypeError("“"+t+"” is not a vimeo.com url.");var r="https://vimeo.com/api/oembed.json?url="+encodeURIComponent(t);for(var n in e)e.hasOwnProperty(n)&&(r+="&"+n+"="+encodeURIComponent(e[n]));var o="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;o.open("GET",r,!0),o.onload=function(){if(404===o.status)return void s(new Error("“"+e+"” was not found."));if(403===o.status)return void s(new Error("“"+e+"” is not embeddable."));try{var t=JSON.parse(o.responseText);i(t)}catch(e){s(e)}},o.onerror=function(){var t=o.status?" ("+o.status+")":"";s(new Error("There was an error fetching the embed code from Vimeo"+t+"."))},o.send()})}function y(t,e){var i=t.html;if(!e)throw new TypeError("An element must be provided");if(null!==e.getAttribute("data-vimeo-initialized"))return e.querySelector("iframe");var s=document.createElement("div");return s.innerHTML=i,e.appendChild(s.firstChild),e.setAttribute("data-vimeo-initialized","true"),e.querySelector("iframe")}function _(){var t=arguments.length<=0||void 0===arguments[0]?document:arguments[0],e=[].slice.call(t.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),i=function(t){"console"in window&&console.error&&console.error("There was an error creating an embed: "+t)},s=function(){if(n){if(o>=r.length)return"break";a=r[o++]}else{if(o=r.next(),o.done)return"break";a=o.value}var t=a;try{if(null!==t.getAttribute("data-vimeo-defer"))return"continue";var e=g(t),s=v(e);m(s,e).then(function(e){return y(e,t)})["catch"](i)}catch(t){i(t)}};t:for(var r=e,n=Array.isArray(r),o=0,r=n?r:r[Symbol.iterator]();;){var a,l=s();switch(l){case"break":break t;case"continue":continue}}}function w(t){return"string"==typeof t&&(t=JSON.parse(t)),t}function b(t,e,i){if(t.element.contentWindow.postMessage){var s={method:e};void 0!==i&&(s.value=i);var r=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));r>=8&&r<10&&(s=JSON.stringify(s)),t.element.contentWindow.postMessage(s,t.origin)}}function $(t,e){e=w(e);var i=[],s=void 0;if(e.event){if("error"===e.event)for(var r=l(t,e.data.method),n=r,o=Array.isArray(n),a=0,n=o?n:n[Symbol.iterator]();;){var u;if(o){if(a>=n.length)break;u=n[a++]}else{if(a=n.next(),a.done)break;u=a.value}var p=u,d=new Error(e.data.message);d.name=e.data.name,p.reject(d),h(t,e.data.method,p)}i=l(t,"event:"+e.event),s=e.data}else e.method&&(i=l(t,e.method),s=e.value,h(t,e.method));for(var c=i,f=Array.isArray(c),v=0,c=f?c:c[Symbol.iterator]();;){var g;if(f){if(v>=c.length)break;g=c[v++]}else{if(v=c.next(),v.done)break;g=v.value}var m=g;try{if("function"==typeof m){m.call(t,s);continue}m.resolve(s)}catch(t){}}}var T="undefined"!=typeof Array.prototype.indexOf,x="undefined"!=typeof window.postMessage;if(!T||!x)throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var E="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:{},C=(o(function(t,e){!function(t){function e(t,e){function s(t){return this&&this.constructor===s?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,void(t&&i.call(this,t))):new s(t)}return e||_(t,"size",{get:g}),t.constructor=s,s.prototype=t,s}function i(t){this.add?t.forEach(this.add,this):t.forEach(function(t){this.set(t[0],t[1])},this)}function s(t){return this.has(t)&&(this._keys.splice(y,1),this._values.splice(y,1),this._itp.forEach(function(t){
y<t[0]&&t[0]--})),-1<y}function r(t){return this.has(t)?this._values[y]:void 0}function n(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(y=t.length;y--&&!w(t[y],e););else y=t.indexOf(e);return-1<y}function o(t){return n.call(this,this._values,t)}function a(t){return n.call(this,this._keys,t)}function l(t,e){return this.has(t)?this._values[y]=e:this._values[this._keys.push(t)-1]=e,this}function h(t){return this.has(t)||this._values.push(t),this}function u(){(this._keys||0).length=this._values.length=0}function p(){return v(this._itp,this._keys)}function d(){return v(this._itp,this._values)}function c(){return v(this._itp,this._keys,this._values)}function f(){return v(this._itp,this._values,this._values)}function v(t,e,i){var s=[0],r=!1;return t.push(s),{next:function(){var n,o=s[0];return!r&&o<e.length?(n=i?[e[o],i[o]]:e[o],s[0]++):(r=!0,t.splice(t.indexOf(s),1)),{done:r,value:n}}}}function g(){return this._values.length}function m(t,e){for(var i=this.entries();;){var s=i.next();if(s.done)break;t.call(e,s.value[1],s.value[0],this)}}var y,_=Object.defineProperty,w=function(t,e){return t===e||t!==t&&e!==e};"undefined"==typeof WeakMap&&(t.WeakMap=e({"delete":s,clear:u,get:r,has:a,set:l},!0)),"undefined"!=typeof Map&&"function"==typeof(new Map).values&&(new Map).values().next||(t.Map=e({"delete":s,has:a,get:r,set:l,keys:p,values:d,entries:c,forEach:m,clear:u})),"undefined"!=typeof Set&&"function"==typeof(new Set).values&&(new Set).values().next||(t.Set=e({has:o,add:h,"delete":s,clear:u,keys:d,values:d,entries:f,forEach:m})),"undefined"==typeof WeakSet&&(t.WeakSet=e({"delete":s,add:h,clear:u,has:o},!0))}("undefined"!=typeof e&&"undefined"!=typeof E?E:window)}),o(function(r){!function(n,o,a){o[n]=o[n]||a(),"undefined"!=typeof r&&r.exports?r.exports=o[n]:i(594)&&(s=function(){return o[n]}.call(e,i,e,t),!(void 0!==s&&(t.exports=s)))}("Promise","undefined"!=typeof E?E:E,function(){function t(t,e){c.add(t,e),d||(d=v(c.drain))}function e(t){var e,i=typeof t;return null==t||"object"!=i&&"function"!=i||(e=t.then),"function"==typeof e&&e}function i(){for(var t=0;t<this.chain.length;t++)s(this,1===this.state?this.chain[t].success:this.chain[t].failure,this.chain[t]);this.chain.length=0}function s(t,i,s){var r,n;try{i===!1?s.reject(t.msg):(r=i===!0?t.msg:i.call(void 0,t.msg),r===s.promise?s.reject(TypeError("Promise-chain cycle")):(n=e(r))?n.call(r,s.resolve,s.reject):s.resolve(r))}catch(t){s.reject(t)}}function r(t){var s,n=this;if(!n.triggered){n.triggered=!0,n.def&&(n=n.def);try{(s=e(t))?a(function(){var e=new l(n);try{s.call(t,function(){r.apply(e,arguments)},function(){o.apply(e,arguments)})}catch(i){o.call(e,i)}}):(n.msg=t,n.state=1,n.chain.length>0&&a(i,n))}catch(a){o.call(new l(n),a)}}}function o(e){var s=this;s.triggered||(s.triggered=!0,s.def&&(s=s.def),s.msg=e,s.state=2,s.chain.length>0&&t(i,s))}function a(t,e,i,s){for(var r=0;r<e.length;r++)!function(r){t.resolve(e[r]).then(function(t){i(r,t)},s)}(r)}function l(t){this.def=t,this.triggered=!1}function h(t){this.promise=t,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var e=new h(this);this.then=function(t,r){var n={success:"function"!=typeof t||t,failure:"function"==typeof r&&r};return n.promise=new this.constructor(function(t,e){if("function"!=typeof t||"function"!=typeof e)throw TypeError("Not a function");n.resolve=t,n.reject=e}),e.chain.push(n),0!==e.state&&s(i,e),n.promise},this["catch"]=function(t){return this.then(void 0,t)};try{t.call(void 0,function(t){r.call(e,t)},function(t){o.call(e,t)})}catch(s){o.call(e,s)}}var p,d,c,f=Object.prototype.toString,v="undefined"!=typeof n?function(t){return n(t)}:setTimeout;try{Object.defineProperty({},"x",{}),p=function(t,e,i,s){return Object.defineProperty(t,e,{value:i,writable:!0,configurable:s!==!1})}}catch(t){p=function(t,e,i){return t[e]=i,t}}c=function(){function t(t,e){this.fn=t,this.self=e,this.next=void 0}var e,i,s;return{add:function(r,n){s=new t(r,n),i?i.next=s:e=s,i=s,s=void 0},drain:function(){var t=e;for(e=i=d=void 0;t;)t.fn.call(t.self),t=t.next}}}();var g=p({},"constructor",u,!1);return u.prototype=g,p(g,"__NPO__",0,!1),p(u,"resolve",function(t){var e=this;return t&&"object"==typeof t&&1===t.__NPO__?t:new e(function(e,i){if("function"!=typeof e||"function"!=typeof i)throw TypeError("Not a function");e(t)})}),p(u,"reject",function(t){return new this(function(e,i){if("function"!=typeof e||"function"!=typeof i)throw TypeError("Not a function");i(t)})}),p(u,"all",function(t){var e=this;return"[object Array]"!=f.call(t)?e.reject(TypeError("Not an array")):0===t.length?e.resolve([]):new e(function(i,s){if("function"!=typeof i||"function"!=typeof s)throw TypeError("Not a function");var r=t.length,n=Array(r),o=0;a(e,t,function(t,e){n[t]=e,++o===r&&i(n)},s)})}),p(u,"race",function(t){var e=this;return"[object Array]"!=f.call(t)?e.reject(TypeError("Not an array")):new e(function(i,s){if("function"!=typeof i||"function"!=typeof s)throw TypeError("Not a function");a(e,t,function(t,e){i(e)},s)})}),u})})),S=C&&"object"==typeof C&&"default"in C?C["default"]:C,k=new WeakMap,O=["id","url","width","maxwidth","height","maxheight","portrait","title","byline","color","autoplay","autopause","loop","responsive"],I=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},G=new WeakMap,D=new WeakMap,P=function(){function t(e){var i=this,s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(I(this,t),window.jQuery&&e instanceof jQuery&&(e.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),e=e[0]),"string"==typeof e&&(e=document.getElementById(e)),!d(e))throw new TypeError("You must pass either a valid element or a valid id.");if("IFRAME"!==e.nodeName){var r=e.querySelector("iframe");r&&(e=r)}if("IFRAME"===e.nodeName&&!f(e.getAttribute("src")||""))throw new Error("The player element passed isn’t a Vimeo embed.");if(G.has(e))return G.get(e);this.element=e,this.origin="*";var n=new S(function(t,r){var n=function(e){if(f(e.origin)&&i.element.contentWindow===e.source){"*"===i.origin&&(i.origin=e.origin);var s=w(e.data),r="event"in s&&"ready"===s.event,n="method"in s&&"ping"===s.method;return r||n?(i.element.setAttribute("data-ready","true"),void t()):void $(i,s)}};if(window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent&&window.attachEvent("onmessage",n),"IFRAME"!==i.element.nodeName){var o=g(e,s),a=v(o);m(a,o).then(function(t){var s=y(t,e);return i.element=s,u(e,s),t})["catch"](function(t){return r(t)})}});return D.set(this,n),G.set(this.element,this),"IFRAME"===this.element.nodeName&&b(this,"ping"),this}return t.prototype.then=function(t){var e=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.ready().then(t,e)},t.prototype.callMethod=function(t){var e=this,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new S(function(s,r){return e.ready().then(function(){a(e,t,{resolve:s,reject:r}),b(e,t,i)})})},t.prototype.get=function(t){var e=this;return new S(function(i,s){return t=p(t,"get"),e.ready().then(function(){a(e,t,{resolve:i,reject:s}),b(e,t)})})},t.prototype.set=function(t,e){var i=this;return S.resolve(e).then(function(e){if(t=p(t,"set"),void 0===e||null===e)throw new TypeError("There must be a value to set.");return i.ready().then(function(){return new S(function(s,r){a(i,t,{resolve:s,reject:r}),b(i,t,e)})})})},t.prototype.on=function(t,e){if(!t)throw new TypeError("You must pass an event name.");if(!e)throw new TypeError("You must pass a callback function.");if("function"!=typeof e)throw new TypeError("The callback must be a function.");var i=l(this,"event:"+t);0===i.length&&this.callMethod("addEventListener",t)["catch"](function(){}),a(this,"event:"+t,e)},t.prototype.off=function(t,e){if(!t)throw new TypeError("You must pass an event name.");if(e&&"function"!=typeof e)throw new TypeError("The callback must be a function.");var i=h(this,"event:"+t,e);i&&this.callMethod("removeEventListener",t)["catch"](function(t){})},t.prototype.loadVideo=function(t){return this.callMethod("loadVideo",t)},t.prototype.ready=function(){var t=D.get(this);return S.resolve(t)},t.prototype.enableTextTrack=function(t,e){if(!t)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:t,kind:e})},t.prototype.disableTextTrack=function(){return this.callMethod("disableTextTrack")},t.prototype.pause=function(){return this.callMethod("pause")},t.prototype.play=function(){return this.callMethod("play")},t.prototype.unload=function(){return this.callMethod("unload")},t.prototype.getAutopause=function(){return this.get("autopause")},t.prototype.setAutopause=function(t){return this.set("autopause",t)},t.prototype.getColor=function(){return this.get("color")},t.prototype.setColor=function(t){return this.set("color",t)},t.prototype.getCurrentTime=function(){return this.get("currentTime")},t.prototype.setCurrentTime=function(t){return this.set("currentTime",t)},t.prototype.getDuration=function(){return this.get("duration")},t.prototype.getEnded=function(){return this.get("ended")},t.prototype.getLoop=function(){return this.get("loop")},t.prototype.setLoop=function(t){return this.set("loop",t)},t.prototype.getPaused=function(){return this.get("paused")},t.prototype.getTextTracks=function(){return this.get("textTracks")},t.prototype.getVideoEmbedCode=function(){return this.get("videoEmbedCode")},t.prototype.getVideoId=function(){return this.get("videoId")},t.prototype.getVideoTitle=function(){return this.get("videoTitle")},t.prototype.getVideoWidth=function(){return this.get("videoWidth")},t.prototype.getVideoHeight=function(){return this.get("videoHeight")},t.prototype.getVideoUrl=function(){return this.get("videoUrl")},t.prototype.getVolume=function(){return this.get("volume")},t.prototype.setVolume=function(t){return this.set("volume",t)},t}();return _(),P})}).call(e,function(){return this}(),i(592).setImmediate)},592:function(t,e,i){(function(t,s){function r(t,e){this._id=t,this._clearFn=e}var n=i(593).nextTick,o=Function.prototype.apply,a=Array.prototype.slice,l={},h=0;e.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var i=h++,s=!(arguments.length<2)&&a.call(arguments,1);return l[i]=!0,n(function(){l[i]&&(s?t.apply(null,s):t.call(null),e.clearImmediate(i))}),i},e.clearImmediate="function"==typeof s?s:function(t){delete l[t]}}).call(e,i(592).setImmediate,i(592).clearImmediate)},593:function(t,e){function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function n(t){if(p===clearTimeout)return clearTimeout(t);if((p===s||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function o(){v&&c&&(v=!1,c.length?f=c.concat(f):g=-1,f.length&&a())}function a(){if(!v){var t=r(o);v=!0;for(var e=f.length;e;){for(c=f,f=[];++g<e;)c&&c[g].run();g=-1,e=f.length}c=null,v=!1,n(t)}}function l(t,e){this.fun=t,this.array=e}function h(){}var u,p,d=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(t){u=i}try{p="function"==typeof clearTimeout?clearTimeout:s}catch(t){p=s}}();var c,f=[],v=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];f.push(new l(t,e)),1!==f.length||v||r(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},594:function(t,e){(function(e){t.exports=e}).call(e,{})},595:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=void 0;var n=i(571),o=s(n),a=i(596),l=s(a),h=function(){function t(e){return r(this,t),e=e||{},this.$el=$(e.el||""),this.$video=$(),this.src=e.src||"",this.video=null,this.startTime=e.startTime||0,this.endTime=e.endTime||10,this.timer=null,this.fallback=null,this.extension=e.extension,this.seekTimeout=null,this.isSeeking=!1,this.maxHeight=380,this.currentTime=this.startTime,this.render(),this}return t.prototype.__loadedMeta=function(){var t=this.video.videoHeight/this.video.videoWidth,e=this.$el.width(),i=this.$el.width(),s=i*t;s>this.maxHeight&&(s=this.maxHeight,i=s/t),this.$el.data({videoHeight:this.video.videoHeight,videoWidth:this.video.videoWidth,scale:i/e}).css({height:s,width:i}),this._resetVideoLoop(),Giphy.Events.trigger("preview:ready",this.video.duration)},t.prototype.__error=function(){this.remove(),o["default"].show("INVALID_VIDEO")},t.prototype.__seeked=function(){this._resetVideoLoop()},t.prototype.__fallbackReady=function(){this._resetVideoLoop(),Giphy.Events.trigger("preview:ready",this.fallback.getDuration())},t.prototype._resetVideoLoop=function(){clearTimeout(this.timer),this.timer=setInterval(_.bind(this._updateVideo,this),100)},t.prototype._updateVideo=function(){this.isSeeking||(this.currentTime>=this.endTime&&(this.currentTime=this.startTime,this.fallback?(clearTimeout(this.timer),this.fallback.setCurrentTime(this.startTime),this.fallback.play()):(clearTimeout(this.timer),this.video.pause(),this.video.currentTime=this.startTime)),this.currentTime+=.1,this.video&&(this.video.paused||this.video.ended)&&this.video.play())},t.prototype._updateFallback=function(){if(this.fallback&&!this.isSeeking){var t=this.fallback.getCurrentTime();t>=this.endTime&&(this.fallback.setCurrentTime(this.startTime),this.fallback.play())}},t.prototype.render=function(){this.src&&this.$el.length&&(this.video=document.createElement("video"),this.video.autoplay=!0,this.video.controls=!1,this.video.loop=!1,this.video.muted=!0,this.video.type="video/mp4",this.video.src=this.src,this.$video=$(this.video),this.$el.html(this.video),this.$video.one("loadedmetadata.video-preview",$.proxy(this.__loadedMeta,this)),this.$video.on("seeked.video-preview",$.proxy(this.__seeked,this)),this.$video.on("error.video-preview",$.proxy(this.__error,this)))},t.prototype.renderQuicktimeFallback=function(){this.fallback=l["default"].initialize({el:this.$el,src:this.src}),Giphy.Events.on("quicktime:ready",this.__fallbackReady,this)},t.prototype.updateTime=function(t,e,i){if(this.fallback||this.video){var s=this.fallback?this.fallback.getDuration():this.video.duration;e=e||1,t=Math.min(t||0,s-e),this.isSeeking=!0,this.startTime=t,this.endTime=t+e,clearTimeout(this.seekTimeout),this.currentTime=i?this.endTime-.001:this.startTime,this.fallback?(this.fallback.pause(),this.fallback.setCurrentTime(this.currentTime)):(this.video.pause(),this.video.currentTime=this.currentTime),this.seekTimeout=setTimeout(_.bind(function(){this.isSeeking=!1,this.fallback?this.fallback.play():this.video.play()},this),1e3)}},t.prototype.remove=function(){this.$el.length&&(this.$video.off(".video-preview"),this.$el.empty().removeData().css({height:"",width:""}),clearTimeout(this.timer),this.fallback&&(this.fallback.remove(),this.fallback=null))},t}();e["default"]=h},596:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(e){return i(this,t),e=e||{},this.$el=$(e.el||""),this.$video=$(),this.src=e.src||"",this.video=null,$.getScript("/static/js/ac_quicktime.js").done($.proxy(this.render,this)),this}return t.prototype.render=function(){if(this.src&&this.$el.length&&window.QT_GenerateOBJECTText){var t=window.QT_GenerateOBJECTText(this.src,"100%","100%","","AUTOPLAY","True","SCALE","Aspect","ENABLEJAVASCRIPT","True","CONTROLLER","False","POSTDOMEVENTS","True","VOLUME","0","NAME","gifpreview");this.$video=$(t),this.video=this.$video.get(0),this.$el.html(this.$video),this.video.addEventListener("qt_load",$.proxy(function(){Giphy.Events.trigger("quicktime:ready")},this))}},t.prototype.pause=function(){document.gifpreview&&document.gifpreview[0].Stop()},t.prototype.play=function(){document.gifpreview&&document.gifpreview[0].Play()},t.prototype.setCurrentTime=function(t){document.gifpreview&&document.gifpreview[0].SetTime(Math.floor(t*document.gifpreview[0].GetTimeScale()))},t.prototype.getDuration=function(){if(document.gifpreview)return document.gifpreview?Math.floor(document.gifpreview[0].GetDuration()/document.gifpreview[0].GetTimeScale()):0},t.prototype.getCurrentTime=function(){if(document.gifpreview)return document.gifpreview?Math.floor(document.gifpreview[0].GetTime()/document.gifpreview[0].GetTimeScale()):0},t.prototype.remove=function(){this.$el.length&&(this.pause(),this.$video.remove())},t}();e["default"]=s},597:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(598),n=s(r);e["default"]=n["default"].extend({defaults:_.extend({},n["default"].prototype.defaults,{defaultTags:"giphygifcaption"}),events:_.extend({},n["default"].prototype.events,{"mouseover .sticker-video":"__videoMouseover","mouseout .sticker-video":"__videoMouseout","click .sticker":"__stickerClicked"}),elements:_.extend({},n["default"].prototype.elements,{$stickers:".stickers-container .sticker"}),__stickerClicked:function(t){var e=$(t.currentTarget),i=e.data("url"),s=e.data("id");_.has(this.progressBars,s)&&(this.progressBars[s].reset(),this.progressBars[s].update(99,2),e.addClass("processing")),Giphy.Events.trigger("gifcanvas:addlayer",i,s)},__videoMouseover:function(t){_.isFunction(t.currentTarget.play)&&t.currentTarget.play()},__videoMouseout:function(t){_.isFunction(t.currentTarget.play)&&t.currentTarget.pause()},renderComplete:function(){n["default"].prototype.renderComplete.call(this,arguments),Giphy.Utils.jazzText(this.$(".jazz-text"),!1,!0)}})},598:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(572),n=s(r),o=i(580),a=s(o),l=i(599),h=s(l);e["default"]=Giphy.BaseView.extend({defaults:{defaultTags:"",optionalFields:null,submitUrl:"",fileTypes:["image/*"]},globalEvents:{"gifcanvas:imageadded":"__gifPreviewComplete","gifcanvas:loading":"__gifPreviewLoading","gifcanvas:ready":"__gifPreviewReady","gifcanvas:animating":"__toggleCreateButton","gifexplorer:resultclick":"__gifExplorerResultClick","fileportal:added":"__addedFile","optionalfields:upload":"__submit"},events:{"click .control-tab":"__tabClicked"},elements:{$gifPreview:".gif-preview",$captionControl:".caption-control",$sectionTabs:".control-tab",$sectionContainers:".controls-container"},__toggleCreateButton:function(t,e,i){if(e)return void Giphy.Events.trigger("uploadbutton:reset");var s=i?"Oops! You need to add a caption!":"Oops! You need to add animation!";Giphy.Events.trigger("uploadbutton:error",s)},__tabClicked:function(t){var e=$(t.currentTarget).data();this._openSection(e.section)},__submit:function(){this.filePortal&&this.filePortal.submit()},__gifPreviewLoading:function(){this.$el.addClass("loading")},__gifPreviewReady:function(){this.$el.removeClass("loading")},__gifPreviewComplete:function(t,e,i){if(_.has(this.progressBars,i)){var s=this.progressBars[i].$el;this.progressBars[i].complete(_.bind(function(){this.progressBars[i].reset(),s.closest(".processing").removeClass("processing")},this))}},__gifExplorerResultClick:function(t,e,i){var s=$(e),r=s.data("sticker-id");r||(r=_.uniqueId(),s.data("sticker-id",r),s.append(this.gifLoadingTemplate())),_.has(this.progressBars,r)||(this.progressBars[r]=new n["default"](s.find(".progress-bar"))),this.progressBars[r].reset(),this.progressBars[r].update(99,2),s.addClass("processing"),Giphy.Events.trigger("gifcanvas:addlayer",i,r)},__addedFile:function(t,e){e&&this.renderGif("url"===e.type?e.name:e)},_openSection:function(t){if(this.$sectionContainers.removeClass("open"),this.$sectionTabs.removeClass("active"),t)this.$sectionContainers.filter('[data-section="'+t+'"]').addClass("open"),this.$sectionTabs.filter('[data-section="'+t+'"]').addClass("active");else{var e=this.$sectionContainers.first().addClass("open"),i=e.data("section");i&&this.$sectionTabs.filter('[data-section="'+i+'"]').addClass("active")}},_resetGifPreview:function(){this.gifPreview&&(this.gifPreview.remove(),this.gifPreview=null),this.captionControl&&this.captionControl.remove()},_renderCaptionControl:function(){this.captionControl||(this.captionControl=new a["default"](this.$captionControl,this.$gifPreview))},_configureFilePortal:function(){this.filePortal||(this.filePortal=new h["default"]({url:this.options.submitUrl,fileTypes:this.options.fileTypes,replaceFile:!0,maxFiles:1,maxTotalFilesize:10,maxVideoLength:15,defaultTags:this.options.defaultTags,parentView:this}))},initialize:function(){this.optionalFields=this.options.optionalFields,this.progressBars={},this.currentLoopType="",this._configureFilePortal(),this.render()},renderComplete:function(){this._openSection(),this._renderCaptionControl(),this.$stickers&&this.$stickers.each(_.bind(function(t,e){var i=$(e),s=_.uniqueId("sticker-");i.data("id",s),this.progressBars[s]=new n["default"](i.find(".progress-bar"))},this));var t=$(".creation-tools-page").data("starting-gif-url");t&&this.filePortal._checkFile(t,!0)},renderGif:function(t){t&&(this._resetGifPreview(),this.gifPreview=new Giphy.GifCanvas({el:this.$gifPreview,image:t,loopType:this.currentLoopType||""}).render())},createGif:function(){var t=$.Deferred();return this.gifPreview?this.gifPreview.createGif().fail(function(){t.reject()}).done(function(e){t.resolve(e)}):t.reject(),t.promise()},gifLoadingTemplate:_.template(['<div class="progress-bar">','<div class="process-complete"><i class="ss-icon ss-check"></i></div>',"</div>"].join(""))})},599:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0,e["default"]=void 0;var a=i(574),l=s(a),h=i(571),u=s(h),p=function(t){function e(){var i,s,o;r(this,e);for(var a=arguments.length,l=Array(a),h=0;h<a;h++)l[h]=arguments[h];return i=s=n(this,t.call.apply(t,[this].concat(l))),s.GIF_COMPILE_LOADING_PCT=50,s.GIF_COMPILE_LOADING_TIME=20,o=i,n(s,o)}return o(e,t),e.prototype.__progress=function(t,e){var i=40,s=this.GIF_COMPILE_LOADING_PCT/100*e+this.GIF_COMPILE_LOADING_PCT;Giphy.Events.trigger("fileportal:progress",{currentFile:1,currentFileName:null,progress:s,totalFiles:1,totalProgress:s,estimatedTime:i})},e.prototype.submit=function(){this.parentView.optionalFields.progressBar.updateWithText("Creating your GIF",this.GIF_COMPILE_LOADING_PCT,this.GIF_COMPILE_LOADING_TIME);var t=this.parentView.createGif();t.done(_.bind(function(t){var e=t;return e.lastModifiedDate=new Date,e.name="upload.gif",e.accepted=!0,this.files().removeAll(),this.files().append(e),this.subviews.files&&this.subviews.files.length()?(this.subviews.dropzone&&(this.subviews.dropzone.options.params=this._getRequestParams(),this._processNextUpload()),void Giphy.Events.trigger("fileportal:submit")):void Giphy.Events.trigger("fileportal:cancel")},this)),t.fail(function(){u["default"].show("SOMETHING_WENT_WRONG")})},e}(l["default"]);e["default"]=p},600:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(598),n=s(r),o=i(601),a=s(o);e["default"]=n["default"].extend({defaults:_.extend({},n["default"].prototype.defaults,{defaultTags:"giphygifeditor"}),events:_.extend({},n["default"].prototype.events,{"change .filter-options .radio-options":"__filterOptionsChange","change .loop-options .radio-options":"__loopTypeChange"}),globalEvents:_.extend({},n["default"].prototype.globalEvents,{"gifcanvas:filterstart":"__filterStarted","gifcanvas:filterfinished":"__filterFinished"}),__toggleCreateButton:function(t,e){return e?void Giphy.Events.trigger("uploadbutton:reset"):void Giphy.Events.trigger("uploadbutton:error","Oops! You need to add animation!")},__filterStarted:function(){this.$el.addClass("applying-filter"),Giphy.Events.trigger("uploadbutton:error","Applying filter...")},__filterFinished:function(){this.$el.removeClass("applying-filter"),Giphy.Events.trigger("uploadbutton:reset")},__filterOptionsChange:function(t,e){e&&Giphy.Events.trigger("gifcanvas:filterlayerchange",e)},__loopTypeChange:function(t,e){this.currentLoopType=e||"",Giphy.Events.trigger("gifcanvas:looptype",this.currentLoopType)},renderComplete:function(){if(n["default"].prototype.renderComplete.call(this,arguments),this.stickerSearch=new Giphy.GifExplorer({el:this.$(".gif-explorer"),featured:this.options.featuredSearches,isStickerSearch:!0}),Giphy.GifFilters){var t=[{filter:"",title:"None",isAnimated:!1}];_.each(Giphy.GifFilters.filters,function(e,i){t.push({filter:i,title:e.label,isAnimated:e.animated||!1})}),this.filterCarousel=new a["default"]({el:this.$(".gif-filters"),items:t}).render()}}})},601:function(t,e){"use strict";e.__esModule=!0,e["default"]=Giphy.Carousel.extend({defaults:_.extend({},Giphy.Carousel.prototype.defaults,{maxBlocks:4,showPagination:!0}),globalEvents:{"gifcanvas:baselayerready":"__gifPreviewReady","gifcanvas:filter":"__addFilter"},__itemClick:function(t){t.preventDefault();var e=$(t.currentTarget),i=e.data();e.hasClass("selected")||Giphy.Events.trigger("gifcanvas:filter",i.filter,i.animated||!1)},__addFilter:function(t,e){e=e||"",this.currentFilter=e,this.$items.find(".item").each(function(t,i){var s=$(i),r=s.data();s.toggleClass("selected",r.filter===e)})},__gifPreviewReady:function(t,e,i){i&&(this.renderedFilters={},this.frameData=i,this._drawFilterPreview(),Giphy.Events.trigger("gifcanvas:filter",this.currentFilter))},_renderItemContent:function(t){this.$items.empty(),_.each(t,function(t,e){this.$items.eq(e).html(this.itemTemplate(_.extend(t,{isSelected:this.currentFilter===t.filter})))},this),this._drawFilterPreview()},_drawFilterPreview:function(){this.frameData&&this.$items.find(".item").each(_.bind(function(t,e){var i=$(e),s=i.find(".filter-canvas"),r=i.attr("data-filter"),n=s.get(0),o=n.getContext("2d"),a=this.frameData.image||this.frameData,l=a.width/a.height,h=0,u=0,p=0;if(o.clearRect(0,0,n.width,n.height),n.width=Math.min(a.width,a.height),n.height=n.width,p=n.width*l,l<1?(h=0,u=.5*(n.height-p)):(h=.5*(n.width-a.width),u=0),_.has(this.frameData,"image")?o.drawImage(this.frameData.image,h,u):o.putImageData(this.frameData.data,h,u),r)if(_.has(this.renderedFilters,r))o.putImageData(this.renderedFilters[r],0,0);else if(Giphy.GifFilters){var d=o.getImageData(0,0,n.width,n.height);Giphy.GifFilters.filter(d,r).done(_.bind(function(t){this.renderedFilters[r]=t,o.putImageData(t,0,0)},this))}},this))},initialize:function(){Giphy.Carousel.prototype.initialize.call(this),this.currentFilter="",this.frameData=null,this.renderedFilters={}},itemTemplate:_.template(['<div class="item<% if (isSelected) { %> selected<% } %>" data-filter="<%- filter %>" data-animated="<%- isAnimated %>">','<div class="item-image">','<canvas class="filter-canvas"></canvas>',"</div>",'<div class="item-label">','<span class="item-label-text"><%- title %></span>',"</div>","</div>"].join(""))})}});
//# sourceMappingURL=creationTools.bundle.js.map